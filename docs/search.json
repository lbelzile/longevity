[{"path":"https://lbelzile.github.io/longevity/README.knit.html","id":null,"dir":"","previous_headings":"","what":"longevity ","title":"longevity ","text":"longevity package proposes estimation routines modeling excess lifetime. Core functionalities include maximum likelihood estimation parametric models (exponential, Gompertz, Weibull, generalized Pareto, extended generalized Pareto, piecewise generalized Pareto), threshold selection plots survival data, nonparametric maximum likelihood estimation, profile likelihood estimation endpoint distribution exceedances.","code":""},{"path":"https://lbelzile.github.io/longevity/README.knit.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"longevity ","text":"can install development version longevity GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"lbelzile/longevity\")"},{"path":"https://lbelzile.github.io/longevity/README.knit.html","id":"current-features","dir":"","previous_headings":"","what":"Current features","title":"longevity ","text":"maximum likelihood estimation routines simulation left-truncated right-truncated/right-censored data hazard plots profile-likelihood based confidence intervals threshold selection diagnostics profile Wald pointwise confidence intervals quantile-quantile plots likelihood ratio tests nested models likelihood ratio tests categorical explanatory likelihood ratio tests changepoints score likelihood ratio tests piecewise generalized Pareto distribution, extending Northrop Coleman (2014), p-value paths nonparametric maximum likelihood estimate distribution function arbitrary truncation censoring using EM algorithm Turnbull (1976) - C++ implementation. profile likelihood generalized Pareto (endpoint) Adapt npsurv interval censoring","code":""},{"path":"https://lbelzile.github.io/longevity/README.knit.html","id":"improvements","dir":"","previous_headings":"","what":"Improvements","title":"longevity ","text":"Add logistic-type models, including distributions, optimization routines, tests Add empirical distribution function npelife npsurv Fix npsurv add weighting argument Cpp routine. Remove/keep Kolmogorov-Smirnov test (depending whether makes sense given null distribution) Add plots (local) hazards delta-method based confidence intervals Change bootstrap procedure Q-Q plots graphical diagnostics S3 methods","code":""},{"path":"https://lbelzile.github.io/longevity/README.knit.html","id":"testing","dir":"","previous_headings":"","what":"Testing","title":"longevity ","text":"right-censoring left-truncation (Bell-Lynden estimator) left-truncation right-censoring (Tsai, Jewell Wang) Frydman (1994) correction interval censored truncated data double truncation Check functions fail packages listed ‘Suggests’ absent Check distributions proper nesting relationships Check ANOVA nesting works expected (null distribution) Check distributions Fix starting values gomp gompmake make sure model good submodel Verify fitting procedure multiple instances, including interval censoring, left right truncation, etc. Check plots type produced base R ggplot2","code":""},{"path":"https://lbelzile.github.io/longevity/README.knit.html","id":"package-on-cran","dir":"","previous_headings":"","what":"Package on CRAN","title":"longevity ","text":"Add tests examples function Add vignettes Use pkgdown create webpage Root data sets go CRAN (accompanying examples) Submit CRAN","code":""},{"path":"https://lbelzile.github.io/longevity/articles/npmle.html","id":"example-kaplanmeier-product-limit-estimator","dir":"Articles","previous_headings":"","what":"Example: Kaplan–Meier product limit estimator","title":"Nonparametric maximum likelihood estimation","text":"one instance closed-form solution, provided celebrated product limit estimator (Kaplan Meier 1958). Consider data exhibiting random right censoring, meaning \\(V_i = 0, U_i = \\infty\\) either \\(L_i=R_i\\) \\(L_i < R_i = \\infty\\). next order observations \\(L_1 \\leq L_2 \\leq \\cdots\\), gives \\(C = \\bigsqcup_{j: L_j=R_j} \\{L_j\\}\\) largest failure time observed \\(C = \\bigsqcup_{j: L_j=R_j} \\{L_j\\} \\sqcup [L_n, \\infty)\\) last observation censored, case resulting distribution function deficient. distribution function undefined jumps (observed failure times).","code":""},{"path":"https://lbelzile.github.io/longevity/articles/npmle.html","id":"lynden-bell-estimator-for-random-left-truncation","dir":"Articles","previous_headings":"","what":"Lynden-Bell estimator for random left truncation","title":"Nonparametric maximum likelihood estimation","text":"Let \\(q_j\\) \\((j=1, \\ldots, m)\\) denote unique failure times let \\(V_i\\) \\((=1, \\ldots, n)\\) denote left truncation bounds. estimator survival function analogous product-limit estimator (Lynden-Bell 1971), \\[\\begin{align*} \\widehat{S}_n(t) = \\prod_{q_j \\leq t} \\left(1- \\frac{d_j}{r_j}\\right) \\end{align*}\\] \\(d_j\\) number instances \\(q_j\\) (, number failures time \\(q_j\\)) \\(r_j\\) number elements risk time \\(q_j\\), viz. \\(\\#\\{: V_i < q_j \\leq T_i\\}\\). case, sets forming \\(C\\) unique instances failure times \\(q_j\\) \\((j=1, \\ldots, m)\\) nonparametric MLE distribution function 1 beyond \\(q_m\\).","code":""},{"path":"https://lbelzile.github.io/longevity/articles/npmle.html","id":"left-truncated-right-censored-observations","dir":"Articles","previous_headings":"","what":"Left-truncated right-censored observations","title":"Nonparametric maximum likelihood estimation","text":"Tsai, Jewell, Wang (1987) provide closed-form solution observations left truncated right censored.","code":""},{"path":[]},{"path":"https://lbelzile.github.io/longevity/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Leo Belzile. Author, maintainer.","code":""},{"path":"https://lbelzile.github.io/longevity/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Belzile L (2023). longevity: Statistical methods analysis excess lifetimes. R package version 2023.03.22, https://lbelzile.github.io/longevity/.","code":"@Manual{,   title = {longevity: Statistical methods for the analysis of excess lifetimes},   author = {Leo Belzile},   year = {2023},   note = {R package version 2023.03.22},   url = {https://lbelzile.github.io/longevity/}, }"},{"path":"https://lbelzile.github.io/longevity/index.html","id":"longevity-","dir":"","previous_headings":"","what":"Statistical methods for the analysis of excess lifetimes","title":"Statistical methods for the analysis of excess lifetimes","text":"longevity package proposes estimation routines modeling excess lifetime. Core functionalities include maximum likelihood estimation parametric models (exponential, Gompertz, Weibull, generalized Pareto, extended generalized Pareto, piecewise generalized Pareto), threshold selection plots survival data, nonparametric maximum likelihood estimation, profile likelihood estimation endpoint distribution exceedances.","code":""},{"path":"https://lbelzile.github.io/longevity/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Statistical methods for the analysis of excess lifetimes","text":"can install development version longevity GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"lbelzile/longevity\")"},{"path":"https://lbelzile.github.io/longevity/index.html","id":"current-features","dir":"","previous_headings":"","what":"Current features","title":"Statistical methods for the analysis of excess lifetimes","text":"maximum likelihood estimation routines simulation left-truncated right-truncated/right-censored data hazard plots profile-likelihood based confidence intervals threshold selection diagnostics profile Wald pointwise confidence intervals quantile-quantile plots likelihood ratio tests nested models likelihood ratio tests categorical explanatory likelihood ratio tests changepoints score likelihood ratio tests piecewise generalized Pareto distribution, extending Northrop Coleman (2014), p-value paths nonparametric maximum likelihood estimate distribution function arbitrary truncation censoring using EM algorithm Turnbull (1976) - C++ implementation. profile likelihood generalized Pareto (endpoint) Adapt npsurv interval censoring","code":""},{"path":"https://lbelzile.github.io/longevity/index.html","id":"improvements","dir":"","previous_headings":"","what":"Improvements","title":"Statistical methods for the analysis of excess lifetimes","text":"Add logistic-type models, including distributions, optimization routines, tests Add empirical distribution function npelife npsurv Fix npsurv add weighting argument Cpp routine. Remove/keep Kolmogorov-Smirnov test (depending whether makes sense given null distribution) Add plots (local) hazards delta-method based confidence intervals Change bootstrap procedure Q-Q plots graphical diagnostics S3 methods","code":""},{"path":"https://lbelzile.github.io/longevity/index.html","id":"testing","dir":"","previous_headings":"","what":"Testing","title":"Statistical methods for the analysis of excess lifetimes","text":"right-censoring left-truncation (Bell-Lynden estimator) left-truncation right-censoring (Tsai, Jewell Wang) Frydman (1994) correction interval censored truncated data double truncation Check functions fail packages listed ‘Suggests’ absent Check distributions proper nesting relationships Check ANOVA nesting works expected (null distribution) Check distributions Fix starting values gomp gompmake make sure model good submodel Verify fitting procedure multiple instances, including interval censoring, left right truncation, etc. Check plots type produced base R ggplot2","code":""},{"path":"https://lbelzile.github.io/longevity/index.html","id":"package-on-cran","dir":"","previous_headings":"","what":"Package on CRAN","title":"Statistical methods for the analysis of excess lifetimes","text":"Add tests examples function Add vignettes Use pkgdown create webpage Root data sets go CRAN (accompanying examples) Submit CRAN","code":""},{"path":"https://lbelzile.github.io/longevity/reference/boxcox_transfo.html","id":null,"dir":"Reference","previous_headings":"","what":"Box-Cox transformation function — boxcox_transfo","title":"Box-Cox transformation function — boxcox_transfo","text":"Given vector parameters, apply Box-Cox transformation.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/boxcox_transfo.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Box-Cox transformation function — boxcox_transfo","text":"","code":"boxcox_transfo(par, lambda = rep(1, length(par)))"},{"path":"https://lbelzile.github.io/longevity/reference/conf_interv.html","id":null,"dir":"Reference","previous_headings":"","what":"Confidence intervals for profile likelihoods — conf_interv","title":"Confidence intervals for profile likelihoods — conf_interv","text":"code adapted mev package.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/conf_interv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Confidence intervals for profile likelihoods — conf_interv","text":"","code":"conf_interv(   object,   level = 0.95,   prob = c((1 - level)/2, 1 - (1 - level)/2),   print = FALSE,   ... )"},{"path":"https://lbelzile.github.io/longevity/reference/conf_interv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Confidence intervals for profile likelihoods — conf_interv","text":"object list containing information profile likelihood format hoa package level probability level confidence interval prob vector length 2 containing bounds, default double-sided print logical indicating whether intervals printed console ... additional arguments passed function","code":""},{"path":"https://lbelzile.github.io/longevity/reference/conf_interv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Confidence intervals for profile likelihoods — conf_interv","text":"table confidence intervals.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dbeard.html","id":null,"dir":"Reference","previous_headings":"","what":"Density function of the Beard distribution — dbeard","title":"Density function of the Beard distribution — dbeard","text":"Density function Beard distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dbeard.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density function of the Beard distribution — dbeard","text":"","code":"dbeard(x, rate = 1, shape1 = 1, shape2 = 1, log = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/dbeard.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density function of the Beard distribution — dbeard","text":"x vector quantiles. rate rate parameter (\\(\\nu\\)) shape1 shape parameter (\\(\\alpha\\)) shape2 shape parameter (\\(\\beta\\)) log logical; FALSE (default), return density, else log likelihood individual observations.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dbeard.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density function of the Beard distribution — dbeard","text":"vector (log)-density.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dbeardmake.html","id":null,"dir":"Reference","previous_headings":"","what":"Density function of the Beard-Makeham distribution — dbeardmake","title":"Density function of the Beard-Makeham distribution — dbeardmake","text":"Density function Beard-Makeham distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dbeardmake.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density function of the Beard-Makeham distribution — dbeardmake","text":"","code":"dbeardmake(x, rate = rate, shape1 = 1, shape2 = 1, lambda = 0, log = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/dbeardmake.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density function of the Beard-Makeham distribution — dbeardmake","text":"x vector quantiles. rate shape parameter (\\(\\nu\\)) shape1 shape parameter (\\(\\alpha\\)) shape2 shape parameter (\\(\\beta\\)) lambda exponential rate Makeham component log logical; FALSE (default), return density, else log likelihood individual observations.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dbeardmake.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density function of the Beard-Makeham distribution — dbeardmake","text":"vector (log)-density.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dextgp.html","id":null,"dir":"Reference","previous_headings":"","what":"Density function of the extended generalized Pareto distribution — dextgp","title":"Density function of the extended generalized Pareto distribution — dextgp","text":"Density function extended generalized Pareto distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dextgp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density function of the extended generalized Pareto distribution — dextgp","text":"","code":"dextgp(x, scale = 1, shape1 = 0, shape2 = 0, log = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/dextgp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density function of the extended generalized Pareto distribution — dextgp","text":"scale scale parameter, strictly positive. shape1 positive shape parameter \\(\\beta\\); model defaults generalized Pareto equals zero. shape2 shape parameter \\(\\gamma\\); model reduces Gompertz shape2=0. log logical; TRUE, return log-density","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dextgp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density function of the extended generalized Pareto distribution — dextgp","text":"vector (log)-density length x","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dextweibull.html","id":null,"dir":"Reference","previous_headings":"","what":"Density function of the extended Weibull distribution — dextweibull","title":"Density function of the extended Weibull distribution — dextweibull","text":"Density function extended Weibull distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dextweibull.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density function of the extended Weibull distribution — dextweibull","text":"","code":"dextweibull(x, scale = 1, shape1 = 0, shape2 = 1, log = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/dextweibull.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density function of the extended Weibull distribution — dextweibull","text":"x vector quantiles. scale scale parameter, strictly positive. shape1 shape parameter generalized Pareto component. shape2 shape parameter Weibull component. log logical; FALSE (default), return density, else log likelihood individual observations.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dextweibull.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density function of the extended Weibull distribution — dextweibull","text":"vector (log)-density.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dgomp.html","id":null,"dir":"Reference","previous_headings":"","what":"Density function of the Gompertz distribution — dgomp","title":"Density function of the Gompertz distribution — dgomp","text":"Density function Gompertz distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dgomp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density function of the Gompertz distribution — dgomp","text":"","code":"dgomp(x, scale = 1, shape = 0, log = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/dgomp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density function of the Gompertz distribution — dgomp","text":"x vector quantiles scale positive scale parameter shape non-negative shape parameter log logical; TRUE, return log density","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dgompmake.html","id":null,"dir":"Reference","previous_headings":"","what":"Density function of the Gompertz-Makeham distribution — dgompmake","title":"Density function of the Gompertz-Makeham distribution — dgompmake","text":"Density function Gompertz-Makeham distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dgompmake.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density function of the Gompertz-Makeham distribution — dgompmake","text":"","code":"dgompmake(x, scale = 1, shape = 0, lambda = 0, log = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/dgompmake.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density function of the Gompertz-Makeham distribution — dgompmake","text":"x vector quantiles. scale scale parameter, strictly positive. shape shape parameter. lambda exponential rate","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dgompmake.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density function of the Gompertz-Makeham distribution — dgompmake","text":"vector density","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dgpd.html","id":null,"dir":"Reference","previous_headings":"","what":"Density function of the generalized Pareto distribution — dgpd","title":"Density function of the generalized Pareto distribution — dgpd","text":"Density function generalized Pareto distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dgpd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density function of the generalized Pareto distribution — dgpd","text":"","code":"dgpd(x, loc = 0, scale = 1, shape = 0, log = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/dgpd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density function of the generalized Pareto distribution — dgpd","text":"x vector quantiles. loc location parameter. scale scale parameter, strictly positive. shape shape parameter. log logical; FALSE (default), return density, else log likelihood individual observations.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dgpd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density function of the generalized Pareto distribution — dgpd","text":"vector (log)-density.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dot-censTruncLimits.html","id":null,"dir":"Reference","previous_headings":"","what":"Identification sets — .censTruncLimits","title":"Identification sets — .censTruncLimits","text":"Identification sets","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dot-censTruncLimits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Identification sets — .censTruncLimits","text":"","code":".censTruncLimits(tsets, lcens, rcens, ltrunc, rtrunc, trunc, cens)"},{"path":"https://lbelzile.github.io/longevity/reference/dot-censTruncLimits.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Identification sets — .censTruncLimits","text":"tsets Turnbull's sets lcens numeric vector left censoring rcens numeric vector right censoring ltrunc numeric vector left truncation rtrunc numeric vector right truncation trunc logical observation truncated?","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dot-turnbull_em.html","id":null,"dir":"Reference","previous_headings":"","what":"Turnbull EM algorithm (low storage implementation) — .turnbull_em","title":"Turnbull EM algorithm (low storage implementation) — .turnbull_em","text":"Turnbull EM algorithm (low storage implementation)","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dot-turnbull_em.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Turnbull EM algorithm (low storage implementation) — .turnbull_em","text":"","code":".turnbull_em(   tsets,   lcens,   rcens,   ltrunc,   rtrunc,   weights,   cens = TRUE,   trunc = TRUE,   tol = 1e-12,   zerotol = 1e-10,   maxiter = 100000L )"},{"path":"https://lbelzile.github.io/longevity/reference/dot-turnbull_em.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Turnbull EM algorithm (low storage implementation) — .turnbull_em","text":"tsets Turnbull's sets lcens numeric vector left censoring rcens numeric vector right censoring ltrunc numeric vector left truncation rtrunc numeric vector right truncation weights vector weights observations cens logical; FALSE, censUpp = censLow particular update can avoided EM algorithm tol tolerance level terminating EM algorithm maxiter maximum number iteration EM algorithm","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dot-turnbull_em.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Turnbull EM algorithm (low storage implementation) — .turnbull_em","text":"list probabilities standard errors","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dot-turnbull_intervals.html","id":null,"dir":"Reference","previous_headings":"","what":"Turnbull's sets — .turnbull_intervals","title":"Turnbull's sets — .turnbull_intervals","text":"Given truncation censoring sets, construct disjoint increasing intervals whose left right endpoints lie L R contain members L R","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dot-turnbull_intervals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Turnbull's sets — .turnbull_intervals","text":"","code":".turnbull_intervals(Lcens, Rcens, Ltrunc, Rtrunc, status)"},{"path":"https://lbelzile.github.io/longevity/reference/dot-turnbull_intervals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Turnbull's sets — .turnbull_intervals","text":"Lcens set left censoring limits Rcens vector right censoring limits Ltrunc vector left truncation limits Rtrunc vector right truncation limits status integer vector giving status censoring set","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dot-wecdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Weighted empirical distribution function — .wecdf","title":"Weighted empirical distribution function — .wecdf","text":"Weighted empirical distribution function","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dot-wecdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Weighted empirical distribution function — .wecdf","text":"","code":".wecdf(x, w, type = c(\"dist\", \"surv\"))"},{"path":"https://lbelzile.github.io/longevity/reference/dot-wecdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Weighted empirical distribution function — .wecdf","text":"x vector length n values w vector weights length n type string, one distribution function (dist) survival function (surv)","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dot-wecdf.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Weighted empirical distribution function — .wecdf","text":"Adapted spatstat (c) Adrian Baddeley Rolf Turner","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dperks.html","id":null,"dir":"Reference","previous_headings":"","what":"Density function of the Perks distribution — dperks","title":"Density function of the Perks distribution — dperks","text":"Density function Perks distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dperks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density function of the Perks distribution — dperks","text":"","code":"dperks(x, rate = 1, shape = 1, log = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/dperks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density function of the Perks distribution — dperks","text":"x vector quantiles. rate rate parameter (\\(\\nu\\)) shape shape parameter (\\(\\alpha\\)) log logical; FALSE (default), return density, else log likelihood individual observations.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dperks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density function of the Perks distribution — dperks","text":"vector (log)-density.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dperksmake.html","id":null,"dir":"Reference","previous_headings":"","what":"Density function of the Perks-Makeham distribution — dperksmake","title":"Density function of the Perks-Makeham distribution — dperksmake","text":"Density function Perks-Makeham distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dperksmake.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Density function of the Perks-Makeham distribution — dperksmake","text":"","code":"dperksmake(x, rate = 1, shape = 1, lambda = 0, log = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/dperksmake.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Density function of the Perks-Makeham distribution — dperksmake","text":"x vector quantiles. rate rate parameter (\\(\\nu\\)) shape shape parameter (\\(\\alpha\\)) lambda exponential rate Makeham component log logical; FALSE (default), return density, else log likelihood individual observations.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dperksmake.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Density function of the Perks-Makeham distribution — dperksmake","text":"vector (log)-density.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dutch.html","id":null,"dir":"Reference","previous_headings":"","what":"Dutch survival data — dutch","title":"Dutch survival data — dutch","text":"data frame contains information Dutch died age 92 years 1986 2015. Observations doubly truncated bounds calculated based range plausible values variables. 226 records interval-censored interval-truncated bdate, ddate ndays missing (NA).","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dutch.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dutch survival data — dutch","text":"","code":"dutch"},{"path":"https://lbelzile.github.io/longevity/reference/dutch.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dutch survival data — dutch","text":"data frame 305143 rows 11 variables: ndays survival time (days) bdate smallest plausible birth date given information month birth death survival (Date) bmonth month birth byear year birth ddate largest plausible death date given information  month birth death survival (Date) dmonth month death dyear year death ltrunc minimum age (days); maximum either 92  years number days reached 1986 rtrunc maximum age (days) individual reached end 2015 gender factor indicating gender individual, either female male valid quality flag; individuals born Netherlands, B individuals born abroad died  Netherlands","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dutch.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Dutch survival data — dutch","text":"Statistics Netherlands (CBS). Accessed via Supplemental material Einmahl, Einmahl de Haan (2019)","code":""},{"path":"https://lbelzile.github.io/longevity/reference/dutch.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Dutch survival data — dutch","text":"Einmahl, J.J., J.H.J. Einmahl L. de Haan (2019). Limits Human Life Span Extreme Value Theory, Journal American Statistical Association, 114(527), 1075-1080. https://doi.org/10.1080/01621459.2018.1537912","code":""},{"path":"https://lbelzile.github.io/longevity/reference/elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Excess lifetime distributions — elife","title":"Excess lifetime distributions — elife","text":"Quantile distribution function excess lifetime distribution threshold exceedances.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Excess lifetime distributions — elife","text":"","code":"qelife(   p,   rate,   scale,   shape,   family = c(\"exp\", \"gp\", \"weibull\", \"gomp\", \"gompmake\", \"extgp\", \"extweibull\", \"perks\",     \"perksmake\", \"beard\", \"beardmake\"),   lower.tail = TRUE )  pelife(   q,   rate,   scale,   shape,   family = c(\"exp\", \"gp\", \"weibull\", \"gomp\", \"gompmake\", \"extgp\", \"extweibull\", \"perks\",     \"perksmake\", \"beard\", \"beardmake\"),   lower.tail = TRUE,   log.p = FALSE )  relife(   n,   scale = 1,   shape,   family = c(\"exp\", \"gp\", \"weibull\", \"gomp\", \"gompmake\", \"extgp\", \"extweibull\", \"perks\",     \"perksmake\", \"beard\", \"beardmake\") )  delife(   x,   scale = 1,   rate,   shape,   family = c(\"exp\", \"gp\", \"weibull\", \"gomp\", \"gompmake\", \"extgp\", \"extweibull\", \"perks\",     \"perksmake\", \"beard\", \"beardmake\"),   log = FALSE )"},{"path":"https://lbelzile.github.io/longevity/reference/elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Excess lifetime distributions — elife","text":"p vector probabilities rate rate parameter(s); models Makeham component, last entry part rate vector scale scale parameter shape vector shape parameter(s). family string indicating parametric model, one exp, gp, gomp, gompmake, weibull, extgp, extweibull, perks, perksmake, beard beardmake lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned. q vector quantiles. log.p logical; FALSE (default), values returned probability scale.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/englandwales.html","id":null,"dir":"Reference","previous_headings":"","what":"England and Wales semi-supercentenarian — englandwales","title":"England and Wales semi-supercentenarian — englandwales","text":"data frame contains information 3866 Welsh English died age ranging 105 110 2000 2014 (except two women died late December 1999) subset UK supercentenarians IDL database (5 male, 80 female) died period. records people died age 109 men, plus stratified sample women validated General Register Office (GRO). Observations doubly truncated.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/englandwales.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"England and Wales semi-supercentenarian — englandwales","text":"","code":"englandwales"},{"path":"https://lbelzile.github.io/longevity/reference/englandwales.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"England and Wales semi-supercentenarian — englandwales","text":"data frame 3951 rows 7 variables: ndays survival time (days) bdate birth date (Date) ddate death date (Date) ltrunc minimum age (days); maximum 38350 days (approximately 105 years) number days reached 2000 rtrunc maximum age (days) individual reached end 2014 gender factor indicating gender individual, either female male valid quality flag; validated records, B unchecked records","code":""},{"path":"https://lbelzile.github.io/longevity/reference/englandwales.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"England and Wales semi-supercentenarian — englandwales","text":"Ngaire Coombs, Office National Statistics (ONS)","code":""},{"path":"https://lbelzile.github.io/longevity/reference/englandwales.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"England and Wales semi-supercentenarian — englandwales","text":"original data forwarded IDL staff, 7 dubious records (missing birth day month) excluded. referenced technical reports describes validation procedure details includes (approximate) sampling weights validation sample women died age 105-108.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/englandwales.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"England and Wales semi-supercentenarian — englandwales","text":"Office National Statistics (2016). Accuracy official high-age population estimates, England Wales: evaluation. Technical report, https://www.ons.gov.uk/peoplepopulationandcommunity/birthsdeathsandmarriages/ageing/methodologies/accuracyofofficialhighagepopulationestimatesinenglandandwalesanevaluation","code":""},{"path":"https://lbelzile.github.io/longevity/reference/expit.html","id":null,"dir":"Reference","previous_headings":"","what":"Inverse logistic link function — expit","title":"Inverse logistic link function — expit","text":"Inverse logistic link function","code":""},{"path":"https://lbelzile.github.io/longevity/reference/expit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Inverse logistic link function — expit","text":"","code":"expit(x)"},{"path":"https://lbelzile.github.io/longevity/reference/expit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Inverse logistic link function — expit","text":"x vector real values","code":""},{"path":"https://lbelzile.github.io/longevity/reference/expit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Inverse logistic link function — expit","text":"probability vector","code":""},{"path":"https://lbelzile.github.io/longevity/reference/fit_ditrunc_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit excess lifetime models for doubly interval truncated data — fit_ditrunc_elife","title":"Fit excess lifetime models for doubly interval truncated data — fit_ditrunc_elife","text":"function wrapper around constrained optimization routines different models non-informative censoring truncation patterns.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/fit_ditrunc_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit excess lifetime models for doubly interval truncated data — fit_ditrunc_elife","text":"","code":"fit_ditrunc_elife(   time,   ltrunc1 = NULL,   rtrunc1 = NULL,   ltrunc2 = NULL,   rtrunc2 = NULL,   thresh = 0,   family = c(\"exp\", \"gp\", \"weibull\", \"gomp\", \"gompmake\", \"extgp\", \"gppiece\"),   weights = NULL,   export = FALSE,   start = NULL,   restart = FALSE )"},{"path":"https://lbelzile.github.io/longevity/reference/fit_ditrunc_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit excess lifetime models for doubly interval truncated data — fit_ditrunc_elife","text":"time excess time event follow-time, depending value event ltrunc1 lower truncation limit, default NULL rtrunc1 upper truncation limit, default NULL ltrunc2 lower truncation limit, default NULL rtrunc2 upper truncation limit, default NULL thresh vector thresholds family string; choice parametric family, either exponential (exp), Weibull (weibull), generalized Pareto (gp), Gompertz (gomp), Gompertz-Makeham (gompmake) extended generalized Pareto (extgp). weights weights observations export logical; data included returned object produce diagnostic plots? Default FALSE. start vector starting values optimization routine. NULL, algorithm attempts find default values returns warning false convergence diagnostic . restart logical; multiple starting values attempted? Default FALSE.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/fit_ditrunc_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit excess lifetime models for doubly interval truncated data — fit_ditrunc_elife","text":"object class elife_par","code":""},{"path":"https://lbelzile.github.io/longevity/reference/fit_ditrunc_elife.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Fit excess lifetime models for doubly interval truncated data — fit_ditrunc_elife","text":"extended generalized Pareto model constrained avoid regions likelihood flat \\(\\xi \\[-1, 10]\\) optimization algorithm. standard errors obtained via observed information matrix, calculated using hessian. many instances, shape parameter zero negative, hessian singular estimates returned.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/fit_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit excess lifetime models — fit_elife","title":"Fit excess lifetime models — fit_elife","text":"function wrapper around constrained optimization routines different models non-informative censoring truncation patterns.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/fit_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit excess lifetime models — fit_elife","text":"","code":"fit_elife(   time,   time2 = NULL,   event = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   ltrunc = NULL,   rtrunc = NULL,   thresh = 0,   status = NULL,   family = c(\"exp\", \"gp\", \"weibull\", \"gomp\", \"gompmake\", \"extgp\", \"gppiece\",     \"extweibull\", \"perks\", \"perksmake\", \"beard\", \"beardmake\"),   weights = NULL,   export = FALSE,   start = NULL,   restart = FALSE )"},{"path":"https://lbelzile.github.io/longevity/reference/fit_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit excess lifetime models — fit_elife","text":"time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL thresh vector thresholds status integer vector giving status observation. NULL (default), argument computed internally based type. family string; choice parametric family weights weights observations export logical; data included returned object produce diagnostic plots? Default FALSE. start vector starting values optimization routine. NULL, algorithm attempts find default values returns warning false convergence diagnostic . restart logical; multiple starting values attempted? Default FALSE.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/fit_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit excess lifetime models — fit_elife","text":"object class elife_par","code":""},{"path":"https://lbelzile.github.io/longevity/reference/fit_elife.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Fit excess lifetime models — fit_elife","text":"extended generalized Pareto model constrained avoid regions likelihood flat \\(\\xi \\[-1, 10]\\) optimization algorithm. standard errors obtained via observed information matrix, calculated using hessian. many instances, shape parameter zero negative, hessian singular estimates returned.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/french.html","id":null,"dir":"Reference","previous_headings":"","what":"French semi-supercentenarian — french","title":"French semi-supercentenarian — french","text":"data frame contains information 9853 French semi-supercentenarian, part International Database Longevity (IDL). supercentenarian records validated, random sample semi-supercentenarians validated. Lifetimes interval truncated;people 110 born 1978 people 105 born 1987 included.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/french.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"French semi-supercentenarian — french","text":"","code":"french"},{"path":"https://lbelzile.github.io/longevity/reference/french.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"French semi-supercentenarian — french","text":"data frame 9853 rows 6 variables: ndays survival time (days) bdate birth date (Date) ddate death date (Date) person alive end sampling ltrunc minimum age (days); maximum 38350  days (approximately 105 years) number days  reached January 1st 1978 (supercentenarian) 1987  (semisupercentenarian) rtrunc maximum age (days) individual reached end 2017 gender factor indicating gender individual, either female male","code":""},{"path":"https://lbelzile.github.io/longevity/reference/french.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"French semi-supercentenarian — french","text":"International Database Longevity","code":""},{"path":"https://lbelzile.github.io/longevity/reference/gppiece.html","id":null,"dir":"Reference","previous_headings":"","what":"Piece-wise generalized Pareto distribution — gppiece","title":"Piece-wise generalized Pareto distribution — gppiece","text":"Density, distribution, quantile functions random number generation mixture model Northrop Coleman (2014), consists m different generalized Pareto distributions non-overlapping intervals m shape parameters one scale parameter; scale parameters constrained resulting distribution continuous domain reduces generalized Pareto distribution shape parameters equal.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/gppiece.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Piece-wise generalized Pareto distribution — gppiece","text":"","code":"dgppiece(x, scale, shape, thresh, log = FALSE)  pgppiece(q, scale, shape, thresh, lower.tail = TRUE, log.p = FALSE)  qgppiece(p, scale, shape, thresh, lower.tail = TRUE, log.p = FALSE)  rgppiece(n, scale, shape, thresh)"},{"path":"https://lbelzile.github.io/longevity/reference/gppiece.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Piece-wise generalized Pareto distribution — gppiece","text":"x, q vector quantiles scale positive value first scale parameter shape vector m shape parameters thresh vector m thresholds log, log.p logical; TRUE, probabilities \\(p\\) given \\(\\log(p)\\). lower.tail logical; TRUE (default), probabilities \\(\\Pr[X \\leq x]\\) otherwise, \\(\\Pr[X > x]\\).","code":""},{"path":"https://lbelzile.github.io/longevity/reference/gppiece.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Piece-wise generalized Pareto distribution — gppiece","text":"Northrop & Coleman (2014). Improved threshold diagnostic plots extreme value analyses, Extremes, 17(2), 289--303.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/hazard_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Profile likelihood for hazard — hazard_elife","title":"Profile likelihood for hazard — hazard_elife","text":"function computes hazard different elife parametric models profile-likelihood based confidence intervals. also used provide local hazard plots varying thresholds.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/hazard_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Profile likelihood for hazard — hazard_elife","text":"","code":"hazard_elife(   x,   time,   time2 = NULL,   event = NULL,   status = NULL,   thresh = 0,   ltrunc = NULL,   rtrunc = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   family = c(\"exp\", \"gp\", \"gomp\", \"gompmake\", \"weibull\", \"extgp\"),   weights = rep(1, length(time)),   level = 0.95,   psi = NULL,   plot = FALSE )"},{"path":"https://lbelzile.github.io/longevity/reference/hazard_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Profile likelihood for hazard — hazard_elife","text":"x value threshold exceedance estimate hazard time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. status integer vector giving status observation. NULL (default), argument computed internally based type. thresh vector thresholds ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". family string; choice parametric family weights weights observations level numeric; level confidence intervals. Default 0.95 psi optional vector hazard compute profile log likelihood plot logical; true, display profile log-likelihood. Default FALSE.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/hazard_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Profile likelihood for hazard — hazard_elife","text":"invisible object class elife_hazard containing information profile likelihood","code":""},{"path":"https://lbelzile.github.io/longevity/reference/hazard_elife.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Profile likelihood for hazard — hazard_elife","text":"","code":"n <- 2500 time <- samp_elife(n = n, scale = 2, family = \"gp\", shape = 0.1, lower = ltrunc <- runif(n), upper = rtrunc <- (5 + runif(n)), type2 = \"ltrt\") hazard_elife(x = 2, time = time,  ltrunc = ltrunc, rtrunc = rtrunc, family = \"exp\")"},{"path":"https://lbelzile.github.io/longevity/reference/hazard_fn_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Hazard function for various parametric models — hazard_fn_elife","title":"Hazard function for various parametric models — hazard_fn_elife","text":"Hazard function various parametric models","code":""},{"path":"https://lbelzile.github.io/longevity/reference/hazard_fn_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hazard function for various parametric models — hazard_fn_elife","text":"","code":"hazard_fn_elife(   x,   par,   family = c(\"exp\", \"gp\", \"gomp\", \"gompmake\", \"weibull\", \"extgp\") )"},{"path":"https://lbelzile.github.io/longevity/reference/hazard_fn_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Hazard function for various parametric models — hazard_fn_elife","text":"x vector points evaluate hazard function par vector scale shape parameters family string; choice parametric family","code":""},{"path":"https://lbelzile.github.io/longevity/reference/hazard_fn_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Hazard function for various parametric models — hazard_fn_elife","text":"vector value hazard function x","code":""},{"path":"https://lbelzile.github.io/longevity/reference/idl.html","id":null,"dir":"Reference","previous_headings":"","what":"International Database on Longevity (2021) — idl","title":"International Database on Longevity (2021) — idl","text":"database contains data downloaded supercentenarian.org, including third first waves, new data provided ONS semisupercentenarian, data Switzerland Italy previously available download removed confidentiality. Data Japan people aged less 110 USA excluded dubious quality. USA, semisupercentenarian records validated, fraction cohort whose size unknown representative whole population. birth death dates USA people unknown (years given, largest plausible range recorded given survival years).","code":""},{"path":"https://lbelzile.github.io/longevity/reference/idl.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"International Database on Longevity (2021) — idl","text":"","code":"idl"},{"path":"https://lbelzile.github.io/longevity/reference/idl.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"International Database on Longevity (2021) — idl","text":"data frame 17721 rows 10 variables: country factor, one CH (Switzerland), OS (Austria), (Belgium), QC (Quebec), DE (Germany), DN (Denmark), ES (Spain), FI (Finland), FR (France), (Norway), SV (Sweden), EW (England Wales), (Italy) US (United States America) ndays integer; survival (days) ageyear integer; floor maximum age (years) reached death gender factor; male female bdate Date; birth date (except US) ddate Date; death date (except US) ltrunc1 integer; lower truncation limit (days); minimum number days someone survived included sampling frame (first interval) rtrunc1 integer; upper truncation limit (days); maximum number days someone survived included sampling frame (first interval) ltrunc2 integer; lower truncation limit (days); minimum number days someone survived included sampling frame (second interval) applicable, NA otherwise rtrunc2 integer; upper truncation limit (days); maximum number days someone survived included sampling frame (second interval) applicable, NA otherwise","code":""},{"path":"https://lbelzile.github.io/longevity/reference/idl.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"International Database on Longevity (2021) — idl","text":"dead individuals included, records truncated. countries semisupercentenarians different collection period semisupercentenarians (105-109) supercentenarians (110+), configurations leading double interval truncation, case data defined \\([\\code{ltrunc1}, \\code{rtrunc1}] \\cup [\\code{ltrunc2},\\code{rtrunc2}]\\).","code":""},{"path":"https://lbelzile.github.io/longevity/reference/idl.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"International Database on Longevity (2021) — idl","text":"International Database Longevity","code":""},{"path":"https://lbelzile.github.io/longevity/reference/idlmetadata.html","id":null,"dir":"Reference","previous_headings":"","what":"IDL metadata — idlmetadata","title":"IDL metadata — idlmetadata","text":"data frame contains country codes associated data collection period corresponding range age death.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/idlmetadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"IDL metadata — idlmetadata","text":"","code":"idlmetadata"},{"path":"https://lbelzile.github.io/longevity/reference/idlmetadata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"IDL metadata — idlmetadata","text":"data frame 21 rows 4 variables: country factor, one AUT (Austria), BEL (Belgium), CAN (Quebec), DEU (Germany), DNK (Denmark), ESP (Spain), FIN (Finland), FRA (France), JPN (Japan), (Norway), SWE (Sweden), EAW (England Wales) USA (United States America) group factor, either 105-109 semi-supercentenarians 110+ supercentenarians\" ldate Date, smallest death date rdate Date, latest death date","code":""},{"path":"https://lbelzile.github.io/longevity/reference/idlmetadata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"IDL metadata — idlmetadata","text":"Due confidentiality restrictions, data available previous versions IDL Switzerland, Italy entries Japan Belgium removed. IDL metadata updated somewhat regularly former versions database preserved, results published analyses replicable reproducible.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/idlmetadata.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"IDL metadata — idlmetadata","text":"International Database Longevity, extracted February 13th, 2023","code":""},{"path":"https://lbelzile.github.io/longevity/reference/italian.html","id":null,"dir":"Reference","previous_headings":"","what":"Italian semi-supercentenarian — italian","title":"Italian semi-supercentenarian — italian","text":"data frame contains information 3836 Italians individually validated survival lifetimes times days persons Italy least 105 years old point period 1 January 2009 31 December 2015. Observations left-truncated right-censored. data publicly available, can purchased Italian National Institute Statistics registering Contact Center mentioning Semi-supercentenarian Survey Marco Marsili contact person.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/italian.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Italian semi-supercentenarian — italian","text":"","code":"italian"},{"path":"https://lbelzile.github.io/longevity/reference/italian.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Italian semi-supercentenarian — italian","text":"data frame 3836 rows 6 variables: ndays survival time (days) bdate birth date (Date) ddate death date (Date), NA_Date_ person alive end sampling ltrunc minimum age (days); maximum 38351 days (approximately 105 years) number days reached 2009 event integer indicating censoring pattern; 0 right-censored records, 1 fully observed gender factor indicating gender individual, either female male","code":""},{"path":"https://lbelzile.github.io/longevity/reference/italian.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Italian semi-supercentenarian — italian","text":"Istituto Nazionale di Statistica","code":""},{"path":"https://lbelzile.github.io/longevity/reference/japanese.html","id":null,"dir":"Reference","previous_headings":"","what":"Japanese survival data — japanese","title":"Japanese survival data — japanese","text":"data frame contains information counts dead Japanese gender year birth (cohort), categorized whole part age attained death.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/japanese.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Japanese survival data — japanese","text":"","code":"japanese"},{"path":"https://lbelzile.github.io/longevity/reference/japanese.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Japanese survival data — japanese","text":"data frame 1038 rows 4 variables: age integer, age (smallest year) death (years) byear integer, birth year count integer, number death cohort given age gender factor, gender individuals; either male female","code":""},{"path":"https://lbelzile.github.io/longevity/reference/japanese.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Japanese survival data — japanese","text":"Table extracted Hanayama & Sibuya (2016).","code":""},{"path":"https://lbelzile.github.io/longevity/reference/japanese.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Japanese survival data — japanese","text":"data obtained Annual Vital Statistics Report Japan, released Japanese government every year since 1947. authors note \"members cohort died end observation period, procedure referred extinct cohort method\". data obtained Human Mortality Database authors. positive counts reported two records (Misao Okawa Jiroemon Kimura) excluded correspond selection mechanism.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/japanese.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Japanese survival data — japanese","text":"Hanayama, N. M. Sibuya (2016). Estimating Upper Limit Lifetime Probability Distribution, Based Data Japanese Centenarians, Journals Gerontology: Series , 71(8), 1014–1021. https://doi.org/10.1093/gerona/glv113","code":""},{"path":"https://lbelzile.github.io/longevity/reference/japanese2.html","id":null,"dir":"Reference","previous_headings":"","what":"Japanese survival data (2) — japanese2","title":"Japanese survival data (2) — japanese2","text":"data frame extracted Table 10.3 Chapter 10, \"Centenarians Supercentenarians Japan\", Monograph Exceptional lifespans. data constructed extinct cohort method stratified age cohort (five year group, except 1899-1900) sex. Note family registry system (KOSEKI), introduced 1872, standardized 1886.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/japanese2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Japanese survival data (2) — japanese2","text":"","code":"japanese2"},{"path":"https://lbelzile.github.io/longevity/reference/japanese2.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Japanese survival data (2) — japanese2","text":"data frame 216 rows 4 variables: age integer, age (smallest year) death (years) bcohort factor, birth cohort count integer, number death cohort given age gender factor, gender individuals; either male female","code":""},{"path":"https://lbelzile.github.io/longevity/reference/japanese2.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Japanese survival data (2) — japanese2","text":"Table 10.3","code":""},{"path":"https://lbelzile.github.io/longevity/reference/japanese2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Japanese survival data (2) — japanese2","text":"Saito, Yasuhiko Futoshi Ishii, Jean-Marie Robine (2021). Centenarians Supercentenarians Japan. Exceptional lifespans, Maier, H., Jeune, B., Vaupel, J. W. (Eds.), Demographic research monographs 17 VII, pp. 125-145. Cham, Springer.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/ks_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Goodness-of-fit diagnostics — ks_test","title":"Goodness-of-fit diagnostics — ks_test","text":"Warning: EXPERIMENTAL Compute Kolmogorov-Smirnov test statistic compare simulated null distribution obtained via parametric bootstrap.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/ks_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Goodness-of-fit diagnostics — ks_test","text":"","code":"ks_test(   time,   time2 = NULL,   event = NULL,   thresh = 0,   ltrunc = NULL,   rtrunc = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   family = c(\"exp\", \"gp\", \"weibull\", \"gomp\", \"extgp\", \"gppiece\"),   B = 999L )"},{"path":"https://lbelzile.github.io/longevity/reference/ks_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Goodness-of-fit diagnostics — ks_test","text":"time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. thresh vector thresholds ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". family string; choice parametric family B number bootstrap simulations","code":""},{"path":"https://lbelzile.github.io/longevity/reference/ks_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Goodness-of-fit diagnostics — ks_test","text":"list elements stat: value test statistic pval: p-value obtained via simulation","code":""},{"path":"https://lbelzile.github.io/longevity/reference/ks_test.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Goodness-of-fit diagnostics — ks_test","text":"bootstrap scheme requires simulating new data, fitting parametric model estimating nonparametric maximum likelihood estimate new sample. computationally intensive large samples.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/logit.html","id":null,"dir":"Reference","previous_headings":"","what":"Logistic link function — logit","title":"Logistic link function — logit","text":"Logistic link function","code":""},{"path":"https://lbelzile.github.io/longevity/reference/logit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logistic link function — logit","text":"","code":"logit(x)"},{"path":"https://lbelzile.github.io/longevity/reference/logit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logistic link function — logit","text":"x vector probabilities","code":""},{"path":"https://lbelzile.github.io/longevity/reference/logit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logistic link function — logit","text":"vector real values","code":""},{"path":"https://lbelzile.github.io/longevity/reference/lpost_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Log posterior distribution with MDI priors — lpost_elife","title":"Log posterior distribution with MDI priors — lpost_elife","text":"Log posterior distribution excess lifetime distribution maximal data information priors.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/lpost_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log posterior distribution with MDI priors — lpost_elife","text":"","code":"lpost_elife(   par,   time,   time2 = NULL,   event = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   ltrunc = NULL,   rtrunc = NULL,   family = c(\"exp\", \"gp\", \"gomp\"),   thresh = 0,   weights = rep(1, length(time)),   status = NULL,   ... )"},{"path":"https://lbelzile.github.io/longevity/reference/lpost_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log posterior distribution with MDI priors — lpost_elife","text":"par vector parameters, order scale, rate shape time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL family string; choice parametric family thresh vector thresholds weights weights observations status integer vector giving status observation. NULL (default), argument computed internally based type. ... additional arguments optimization, currently ignored.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nc_score_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Score test of Northrop and Coleman — nc_score_test","title":"Score test of Northrop and Coleman — nc_score_test","text":"function computes score test piecewise generalized Pareto distribution null hypothesis generalized Pareto single shape parameter adequate simplification. score test statistic calculated using observed information matrix; hessian score vector obtained numerical differentiation.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nc_score_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Score test of Northrop and Coleman — nc_score_test","text":"","code":"nc_score_test(   time,   time2 = NULL,   event = NULL,   thresh = 0,   ltrunc = NULL,   rtrunc = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   weights = rep(1, length(time)) )"},{"path":"https://lbelzile.github.io/longevity/reference/nc_score_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Score test of Northrop and Coleman — nc_score_test","text":"time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. thresh vector thresholds ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". weights weights observations","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nc_score_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Score test of Northrop and Coleman — nc_score_test","text":"data frame following variables: thresh: threshold generalized Pareto nexc: number exceedances score: score statistic df: degrees freedom pval: p-value obtained asymptotic chi-square approximation.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nc_score_test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Score test of Northrop and Coleman — nc_score_test","text":"score test much faster perhaps less fragile likelihood ratio test: fitting piece-wise generalized Pareto model difficult due large number parameters multimodal likelihood surface. reference distribution chi-square","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nc_test.html","id":null,"dir":"Reference","previous_headings":"","what":"Score test of Northrop and Coleman — nc_test","title":"Score test of Northrop and Coleman — nc_test","text":"function computes score test piecewise generalized Pareto distribution null hypothesis generalized Pareto single shape parameter adequate simplification. score test statistic calculated using observed information matrix; hessian score vector obtained numerical differentiation.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nc_test.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Score test of Northrop and Coleman — nc_test","text":"","code":"nc_test(   time,   time2 = NULL,   event = NULL,   thresh = 0,   ltrunc = NULL,   rtrunc = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   weights = rep(1, length(time)),   test = c(\"score\", \"lrt\") )"},{"path":"https://lbelzile.github.io/longevity/reference/nc_test.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Score test of Northrop and Coleman — nc_test","text":"time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. thresh vector thresholds ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". weights weights observations test string, either \"score\" score test \"lrt\" likelihood ratio test.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nc_test.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Score test of Northrop and Coleman — nc_test","text":"data frame following variables: thresh: threshold generalized Pareto nexc: number exceedances score: score statistic df: degrees freedom pval: p-value obtained asymptotic chi-square approximation.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nc_test.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Score test of Northrop and Coleman — nc_test","text":"score test much faster perhaps less fragile likelihood ratio test: fitting piece-wise generalized Pareto model difficult due large number parameters multimodal likelihood surface. reference distribution chi-square","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nll_ditrunc_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood for doubly interval truncated data — nll_ditrunc_elife","title":"Likelihood for doubly interval truncated data — nll_ditrunc_elife","text":"Computes log-likelihood various parametric models suitable threshold exceedances. threshold non-zero, right-censored, observed event time interval censored data whose timing exceeds thresholds kept.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nll_ditrunc_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood for doubly interval truncated data — nll_ditrunc_elife","text":"","code":"nll_ditrunc_elife(   par,   time,   ltrunc1 = NULL,   rtrunc1 = NULL,   ltrunc2 = NULL,   rtrunc2 = NULL,   family = c(\"exp\", \"gp\", \"gomp\", \"gompmake\", \"weibull\", \"extgp\", \"gppiece\"),   thresh = 0,   weights = rep(1, length(time)),   ... )"},{"path":"https://lbelzile.github.io/longevity/reference/nll_ditrunc_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood for doubly interval truncated data — nll_ditrunc_elife","text":"par vector parameters time excess time event follow-time, depending value event ltrunc1 lower truncation limit, default NULL rtrunc1 upper truncation limit, default NULL ltrunc2 lower truncation limit, default NULL rtrunc2 upper truncation limit, default NULL family string; choice parametric family, either exponential (exp), Weibull (weibull), generalized Pareto (gp), Gompertz (gomp), Gompertz-Makeham (gompmake) extended generalized Pareto (extgp). thresh vector thresholds weights weights observations ... additional arguments optimization, currently ignored.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nll_ditrunc_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood for doubly interval truncated data — nll_ditrunc_elife","text":"log-likelihood value","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nll_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood for arbitrary censored and truncated data — nll_elife","title":"Likelihood for arbitrary censored and truncated data — nll_elife","text":"Computes log-likelihood various parametric models suitable threshold exceedances. threshold non-zero, right-censored, observed event time interval censored data whose timing exceeds thresholds kept.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nll_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood for arbitrary censored and truncated data — nll_elife","text":"","code":"nll_elife(   par,   time,   time2 = NULL,   event = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   ltrunc = NULL,   rtrunc = NULL,   family = c(\"exp\", \"gp\", \"gomp\", \"gompmake\", \"weibull\", \"extgp\", \"gppiece\",     \"extweibull\", \"perks\", \"beard\", \"perksmake\", \"beardmake\"),   thresh = 0,   weights = rep(1, length(time)),   status = NULL,   ... )"},{"path":"https://lbelzile.github.io/longevity/reference/nll_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood for arbitrary censored and truncated data — nll_elife","text":"par vector parameters, order scale, rate shape time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL family string; choice parametric family thresh vector thresholds weights weights observations status integer vector giving status observation. NULL (default), argument computed internally based type. ... additional arguments optimization, currently ignored.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/nll_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood for arbitrary censored and truncated data — nll_elife","text":"log-likelihood value","code":""},{"path":"https://lbelzile.github.io/longevity/reference/np_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Nonparametric estimation of the survival function — np_elife","title":"Nonparametric estimation of the survival function — np_elife","text":"survival function obtained EM algorithm described Turnbull (1976); censoring truncation assumed non-informative. survival function changes J distinct exceedances \\(y_i-u\\) truncation points.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/np_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Nonparametric estimation of the survival function — np_elife","text":"","code":"np_elife(   time,   time2 = NULL,   event = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   thresh = 0,   ltrunc = NULL,   rtrunc = NULL,   tol = 1e-12,   weights = NULL,   method = c(\"em\", \"sqp\"),   ... )"},{"path":"https://lbelzile.github.io/longevity/reference/np_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Nonparametric estimation of the survival function — np_elife","text":"time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". thresh double thresh ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL tol double, relative tolerance convergence EM algorithm weights double, vector weights observations method string, one \"em\" expectation-maximization (EM) algorithm \"sqp\" sequential quadratic programming augmented Lagrange multiplie method. ... additional arguments, currently ignored","code":""},{"path":"https://lbelzile.github.io/longevity/reference/np_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Nonparametric estimation of the survival function — np_elife","text":"list elements cdf: right-continuous stepfun object defined probabilities time: matrix unique values Turnbull intervals defining equivalence classes; non-zero probabilities returned prob: J vector non-zero probabilities niter: number iterations","code":""},{"path":"https://lbelzile.github.io/longevity/reference/np_elife.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Nonparametric estimation of the survival function — np_elife","text":"function vanilla R implementation EM algorithm; function npsurv uses backbone Cpp implementation faster settings (account thresholds). function can return  variance covariance matrix J-1 estimated probabilities, computed inverting negative hessian incomplete log likelihood. method currently limited 2500 unique failure time, since implementation heavy memory footprint order O(\\(J^2\\)) unknown parameters model \\(p_j (j=1, \\ldots, J)\\) subject constraint \\(\\sum_{j=1}^J p_j=1\\).","code":""},{"path":"https://lbelzile.github.io/longevity/reference/np_elife.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Nonparametric estimation of the survival function — np_elife","text":"","code":"set.seed(2021) n <- 20L # Create fake data ltrunc <- pmax(0, runif(n, -0.5, 1)) rtrunc <- runif(n, 6, 10) dat <- samp_elife(n = n,                   scale = 1,                   shape = -0.1,                   lower = ltrunc,                   upper = rtrunc,                   family = \"gp\",                   type2 = \"ltrt\") npi <- np_elife(time = dat,                 rtrunc = rtrunc,                 ltrunc = ltrunc)"},{"path":"https://lbelzile.github.io/longevity/reference/np_nll.html","id":null,"dir":"Reference","previous_headings":"","what":"Marginal log likelihood function of the nonparametric multinomial with censoring and truncation — np_nll","title":"Marginal log likelihood function of the nonparametric multinomial with censoring and truncation — np_nll","text":"Marginal log likelihood function nonparametric multinomial censoring truncation","code":""},{"path":"https://lbelzile.github.io/longevity/reference/np_nll.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Marginal log likelihood function of the nonparametric multinomial with censoring and truncation — np_nll","text":"","code":"np_nll(par, cens_lb, cens_ub, trunc_lb, trunc_ub, cens, trunc, weights)"},{"path":"https://lbelzile.github.io/longevity/reference/np_nll.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Marginal log likelihood function of the nonparametric multinomial with censoring and truncation — np_nll","text":"par vector D-1 parameters cens_lb index interval death occurs cens_ub index interval death occurs (death observed), else largest interval. trunc_lb vector largest index lower truncation trunc_ub vector smallest index upper truncation transform logical; parameters logit scale? Default TRUE","code":""},{"path":"https://lbelzile.github.io/longevity/reference/npsurv.html","id":null,"dir":"Reference","previous_headings":"","what":"Nonparametric maximum likelihood estimation for arbitrary truncation — npsurv","title":"Nonparametric maximum likelihood estimation for arbitrary truncation — npsurv","text":"syntax reminiscent Surv function, additional vectors left-truncation right-truncation.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/npsurv.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Nonparametric maximum likelihood estimation for arbitrary truncation — npsurv","text":"","code":"npsurv(   time,   time2 = NULL,   event = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   ltrunc = NULL,   rtrunc = NULL,   weights = NULL,   ... )"},{"path":"https://lbelzile.github.io/longevity/reference/npsurv.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Nonparametric maximum likelihood estimation for arbitrary truncation — npsurv","text":"time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL weights vector weights, default NULL equiweighted ... additional arguments passed functions","code":""},{"path":"https://lbelzile.github.io/longevity/reference/npsurv.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Nonparametric maximum likelihood estimation for arbitrary truncation — npsurv","text":"list components xval: unique ordered values sets distribution function defined prob: estimated probability failure intervals convergence: logical; TRUE EM algorithm iterated convergence niter: logical; number iterations EM algorithm cdf: nonparametric maximum likelihood estimator distribution function","code":""},{"path":"https://lbelzile.github.io/longevity/reference/npsurv.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Nonparametric maximum likelihood estimation for arbitrary truncation — npsurv","text":"Contrary Kaplan-Meier estimator, mass placed interval [max(time), Inf) resulting distribution function deficient.","code":""},{"path":[]},{"path":"https://lbelzile.github.io/longevity/reference/pbeard.html","id":null,"dir":"Reference","previous_headings":"","what":"Distribution function of the Beard distribution — pbeard","title":"Distribution function of the Beard distribution — pbeard","text":"Distribution function Beard distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pbeard.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distribution function of the Beard distribution — pbeard","text":"","code":"pbeard(q, rate = 1, shape1 = 1, shape2 = 1, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/pbeard.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distribution function of the Beard distribution — pbeard","text":"q vector quantiles. rate rate parameter (\\(\\nu\\)) shape1 shape parameter (\\(\\alpha\\)) shape2 shape parameter (\\(\\beta\\)) lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned. log.p logical; FALSE (default), values returned probability scale.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pbeard.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distribution function of the Beard distribution — pbeard","text":"vector (log)-probabilities length q","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pbeardmake.html","id":null,"dir":"Reference","previous_headings":"","what":"Distribution function of the Beard-Makeham distribution — pbeardmake","title":"Distribution function of the Beard-Makeham distribution — pbeardmake","text":"Distribution function Beard-Makeham distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pbeardmake.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distribution function of the Beard-Makeham distribution — pbeardmake","text":"","code":"pbeardmake(   q,   rate = 1,   shape1 = 1,   shape2 = 1,   lambda = 0,   lower.tail = TRUE,   log.p = FALSE )"},{"path":"https://lbelzile.github.io/longevity/reference/pbeardmake.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distribution function of the Beard-Makeham distribution — pbeardmake","text":"q vector quantiles. rate shape parameter (\\(\\nu\\)) shape1 shape parameter (\\(\\alpha\\)) shape2 shape parameter (\\(\\beta\\)) lambda exponential rate Makeham component lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned. log.p logical; FALSE (default), values returned probability scale.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pbeardmake.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distribution function of the Beard-Makeham distribution — pbeardmake","text":"vector (log)-probabilities length q","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pextgp.html","id":null,"dir":"Reference","previous_headings":"","what":"Distribution function of the extended generalized Pareto distribution — pextgp","title":"Distribution function of the extended generalized Pareto distribution — pextgp","text":"Distribution function extended generalized Pareto distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pextgp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distribution function of the extended generalized Pareto distribution — pextgp","text":"","code":"pextgp(q, scale = 1, shape1 = 0, shape2 = 0, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/pextgp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distribution function of the extended generalized Pareto distribution — pextgp","text":"q vector quantiles. scale scale parameter, strictly positive. shape1 positive shape parameter \\(\\beta\\); model defaults generalized Pareto equals zero. shape2 shape parameter \\(\\gamma\\); model reduces Gompertz shape2=0. lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned. log.p logical; FALSE (default), values returned probability scale.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pextgp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distribution function of the extended generalized Pareto distribution — pextgp","text":"vector (log)-probabilities length q","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pextweibull.html","id":null,"dir":"Reference","previous_headings":"","what":"Distribution function of the extended Weibull distribution — pextweibull","title":"Distribution function of the extended Weibull distribution — pextweibull","text":"Distribution function extended Weibull distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pextweibull.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distribution function of the extended Weibull distribution — pextweibull","text":"","code":"pextweibull(   q,   scale = 1,   shape1 = 0,   shape2 = 1,   lower.tail = TRUE,   log.p = FALSE )"},{"path":"https://lbelzile.github.io/longevity/reference/pextweibull.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distribution function of the extended Weibull distribution — pextweibull","text":"q vector quantiles. scale scale parameter, strictly positive. shape1 shape parameter generalized Pareto component. shape2 shape parameter Weibull component. lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned. log.p logical; FALSE (default), values returned probability scale.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pextweibull.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distribution function of the extended Weibull distribution — pextweibull","text":"vector (log)-probabilities length q","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pgomp.html","id":null,"dir":"Reference","previous_headings":"","what":"Distribution function of the Gompertz distribution — pgomp","title":"Distribution function of the Gompertz distribution — pgomp","text":"Distribution function Gompertz distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pgomp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distribution function of the Gompertz distribution — pgomp","text":"","code":"pgomp(q, scale = 1, shape = 0, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/pgomp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distribution function of the Gompertz distribution — pgomp","text":"q vector quantiles. scale scale parameter, strictly positive. shape shape parameter. lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned. log.p logical; FALSE (default), values returned probability scale.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pgomp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distribution function of the Gompertz distribution — pgomp","text":"vector (log)-probabilities length q","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pgompmake.html","id":null,"dir":"Reference","previous_headings":"","what":"Distribution function of the Gompertz-Makeham distribution — pgompmake","title":"Distribution function of the Gompertz-Makeham distribution — pgompmake","text":"Distribution function Gompertz-Makeham distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pgompmake.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distribution function of the Gompertz-Makeham distribution — pgompmake","text":"","code":"pgompmake(   q,   scale = 1,   shape = 0,   lambda = 0,   lower.tail = TRUE,   log.p = FALSE )"},{"path":"https://lbelzile.github.io/longevity/reference/pgompmake.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distribution function of the Gompertz-Makeham distribution — pgompmake","text":"q vector quantiles. scale scale parameter, strictly positive. shape shape parameter. lambda exponential rate lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned. log.p logical; FALSE (default), values returned probability scale.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pgompmake.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distribution function of the Gompertz-Makeham distribution — pgompmake","text":"vector (log)-probabilities length q","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pgpd.html","id":null,"dir":"Reference","previous_headings":"","what":"Distribution function of the generalized Pareto distribution — pgpd","title":"Distribution function of the generalized Pareto distribution — pgpd","text":"Distribution function generalized Pareto distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pgpd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distribution function of the generalized Pareto distribution — pgpd","text":"","code":"pgpd(q, loc = 0, scale = 1, shape = 0, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/pgpd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distribution function of the generalized Pareto distribution — pgpd","text":"q vector quantiles. loc location parameter. scale scale parameter, strictly positive. shape shape parameter. lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned. log.p logical; FALSE (default), values returned probability scale.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pgpd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distribution function of the generalized Pareto distribution — pgpd","text":"vector (log)-probabilities length q","code":""},{"path":"https://lbelzile.github.io/longevity/reference/plot.elife_ecdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Approximate uncertainty for diagnostic plots — plot.elife_ecdf","title":"Approximate uncertainty for diagnostic plots — plot.elife_ecdf","text":"Approximate uncertainty resampling parameters estimates using normal approximation maximum likelihood estimators.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/plot.elife_ecdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Approximate uncertainty for diagnostic plots — plot.elife_ecdf","text":"","code":"# S3 method for elife_ecdf plot(x, ...)"},{"path":"https://lbelzile.github.io/longevity/reference/plot.elife_ecdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Approximate uncertainty for diagnostic plots — plot.elife_ecdf","text":"B integer; number simulations object object class elife_par logscale logical; TRUE (default), compute approximation using \\(\\log(\\sigma)\\) rather \\(\\sigma\\)","code":""},{"path":"https://lbelzile.github.io/longevity/reference/plot.elife_northropcoleman.html","id":null,"dir":"Reference","previous_headings":"","what":"P-value plot — plot.elife_northropcoleman","title":"P-value plot — plot.elife_northropcoleman","text":"Northrop-Coleman tests penultimate models comparing piece-wise generalized Pareto distribution generalized Pareto lower threshold.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/plot.elife_northropcoleman.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"P-value plot — plot.elife_northropcoleman","text":"","code":"# S3 method for elife_northropcoleman plot(x, plot.type = c(\"base\", \"ggplot\"), plot = TRUE, ...)"},{"path":"https://lbelzile.github.io/longevity/reference/plot.elife_northropcoleman.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"P-value plot — plot.elife_northropcoleman","text":"x object class elife_northropcoleman plot.type string indicating type plot plot logical; routine print graph plot.type equals \"ggplot\"? Default TRUE. ... additional arguments base plot","code":""},{"path":"https://lbelzile.github.io/longevity/reference/plot.elife_par.html","id":null,"dir":"Reference","previous_headings":"","what":"Goodness-of-fit plots for parametric models — plot.elife_par","title":"Goodness-of-fit plots for parametric models — plot.elife_par","text":"censoring truncation, plotting positions must adjusted accordingly. right-censored data, methodology described Waller & Turnbull (1992). non-censored observations displayed, can create distortion.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/plot.elife_par.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Goodness-of-fit plots for parametric models — plot.elife_par","text":"","code":"# S3 method for elife_par plot(   x,   plot.type = c(\"base\", \"ggplot\"),   which.plot = c(\"pp\", \"qq\"),   confint = FALSE,   plot = TRUE,   ... )"},{"path":"https://lbelzile.github.io/longevity/reference/plot.elife_par.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Goodness-of-fit plots for parametric models — plot.elife_par","text":"x parametric model class elife_par plot.type string, one base base R ggplot .plot vector string indicating plots, among pp probability-probability plot, qq quantile-quantile plot, erp empirically rescaled plot (censored data), exp standard exponential quantile-quantile plot tmd Tukey's mean difference plot, variant Q-Q plot map pair \\((x,y)\\) mapped ((x+y)/2,y-x) detrended confint logical; TRUE, creates uncertainty diagnostic via parametric bootstrap plot logical; TRUE, creates plot plot.type=\"ggplot\". Useful returning ggplot objects without printing graphs ... additional arguments, currently ignored function.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/plot.elife_par.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Goodness-of-fit plots for parametric models — plot.elife_par","text":"truncated data, first estimate distribution function nonparametrically, \\(F_n\\). uniform plotting positions data $$v_i = [F_n(y_i) - F_n(a_i)]/[F_n(b_i) - F_n(a_i)].$$ probability-probability plots, empirical quantiles transformed using transformation, \\(F_n\\) replaced postulated estimated distribution function \\(F_0\\). quantile-quantile plots, plotting positions \\(v_i\\) mapped back data scale viz. $$F_0^{-1}\\{F_0(a_i) + v_i[F_0(b_i) - F_0(a_i)]\\}$$ data truncated observations mapped back untruncated scale (, e.g., exp), plotting positions need order order statistics data.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/plot.elife_par.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Goodness-of-fit plots for parametric models — plot.elife_par","text":"","code":"samp <- samp_elife(  n = 200,  scale = 2,  shape = 0.3,  family = \"gomp\",  lower = 0, upper = runif(200, 0, 10),  type2 = \"ltrc\") fitted <- fit_elife(  time = samp$dat,  thresh = 0,  event = ifelse(samp$rcens, 0L, 1L),  type = \"right\",  family = \"exp\",  export = TRUE) plot(fitted, plot.type = \"ggplot\") #> Error: All vectors of censoring intervals should be of the same length. # Left- and right-truncated data samp <- samp_elife(  n = 200,  scale = 2,  shape = 0.3,  family = \"gp\",  lower = ltrunc <- runif(200),  upper = rtrunc <- ltrunc + runif(200, 0, 10),  type2 = \"ltrt\") fitted <- fit_elife(  time = samp,  thresh = 0,  ltrunc = ltrunc,  rtrunc = rtrunc,  family = \"gp\",  export = TRUE) plot(fitted) #> Warning: EM algorithm failed to converge after 100000 iterations."},{"path":"https://lbelzile.github.io/longevity/reference/pperks.html","id":null,"dir":"Reference","previous_headings":"","what":"Distribution function of the Perks distribution — pperks","title":"Distribution function of the Perks distribution — pperks","text":"Distribution function Perks distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pperks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distribution function of the Perks distribution — pperks","text":"","code":"pperks(q, rate = 1, shape = 1, lower.tail = TRUE, log.p = FALSE)"},{"path":"https://lbelzile.github.io/longevity/reference/pperks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distribution function of the Perks distribution — pperks","text":"q vector quantiles. rate rate parameter (\\(\\nu\\)) shape shape parameter (\\(\\alpha\\)) lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned. log.p logical; FALSE (default), values returned probability scale.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pperks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distribution function of the Perks distribution — pperks","text":"vector (log)-probabilities length q","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pperksmake.html","id":null,"dir":"Reference","previous_headings":"","what":"Distribution function of the Perks-Makeham distribution — pperksmake","title":"Distribution function of the Perks-Makeham distribution — pperksmake","text":"Distribution function Perks-Makeham distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pperksmake.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Distribution function of the Perks-Makeham distribution — pperksmake","text":"","code":"pperksmake(   q,   rate = 1,   shape = 1,   lambda = 0,   lower.tail = TRUE,   log.p = FALSE )"},{"path":"https://lbelzile.github.io/longevity/reference/pperksmake.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Distribution function of the Perks-Makeham distribution — pperksmake","text":"q vector quantiles. rate rate parameter (\\(\\nu\\)) shape shape parameter (\\(\\alpha\\)) lambda exponential rate Makeham component lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned. log.p logical; FALSE (default), values returned probability scale.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/pperksmake.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Distribution function of the Perks-Makeham distribution — pperksmake","text":"vector (log)-probabilities length q","code":""},{"path":"https://lbelzile.github.io/longevity/reference/prof_exp_scale.html","id":null,"dir":"Reference","previous_headings":"","what":"Profile log likelihood for the scale parameter of the exponential distribution — prof_exp_scale","title":"Profile log likelihood for the scale parameter of the exponential distribution — prof_exp_scale","text":"internal function used produce threshold stability plots.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/prof_exp_scale.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Profile log likelihood for the scale parameter of the exponential distribution — prof_exp_scale","text":"","code":"prof_exp_scale(   mle = NULL,   time,   time2 = NULL,   event = NULL,   thresh = 0,   ltrunc = NULL,   rtrunc = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   level = 0.95,   psi = NULL,   weights = NULL,   confint = TRUE )"},{"path":"https://lbelzile.github.io/longevity/reference/prof_exp_scale.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Profile log likelihood for the scale parameter of the exponential distribution — prof_exp_scale","text":"mle object class elife_par time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. thresh vector thresholds ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". level level confidence interval weights weights observations confint logical; TRUE (default), return confidence intervals rather list","code":""},{"path":"https://lbelzile.github.io/longevity/reference/prof_exp_scale.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Profile log likelihood for the scale parameter of the exponential distribution — prof_exp_scale","text":"vector length three maximum likelihood scale profile-based confidence interval","code":""},{"path":"https://lbelzile.github.io/longevity/reference/prof_gp_endpt.html","id":null,"dir":"Reference","previous_headings":"","what":"Profile likelihood for the endpoint of the generalized Pareto distribution — prof_gp_endpt","title":"Profile likelihood for the endpoint of the generalized Pareto distribution — prof_gp_endpt","text":"function returns profile log likelihood grid values psi, endpoints.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/prof_gp_endpt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Profile likelihood for the endpoint of the generalized Pareto distribution — prof_gp_endpt","text":"","code":"prof_gp_endpt(   time,   time2 = NULL,   event = NULL,   thresh = 0,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   ltrunc = NULL,   rtrunc = NULL,   weights = rep(1, length(time)),   psi = NULL,   confint = FALSE,   level = 0.95 )"},{"path":"https://lbelzile.github.io/longevity/reference/prof_gp_endpt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Profile likelihood for the endpoint of the generalized Pareto distribution — prof_gp_endpt","text":"time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. thresh vector thresholds type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL weights weights observations psi mandatory vector endpoints compute profile confint logical; TRUE, return level confidence interval instead list profile log-likelihood components level numeric; level confidence intervals","code":""},{"path":"https://lbelzile.github.io/longevity/reference/prof_gp_endpt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Profile likelihood for the endpoint of the generalized Pareto distribution — prof_gp_endpt","text":"list maximum likelihood estimate endpoint profile log-likelihood","code":""},{"path":"https://lbelzile.github.io/longevity/reference/prof_gp_scalet.html","id":null,"dir":"Reference","previous_headings":"","what":"Profile log likelihood for the transformed scale parameter of the generalized Pareto distribution — prof_gp_scalet","title":"Profile log likelihood for the transformed scale parameter of the generalized Pareto distribution — prof_gp_scalet","text":"internal function used produce threshold stability plots.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/prof_gp_scalet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Profile log likelihood for the transformed scale parameter of the generalized Pareto distribution — prof_gp_scalet","text":"","code":"prof_gp_scalet(   mle = NULL,   time,   time2 = NULL,   event = NULL,   thresh = 0,   ltrunc = NULL,   rtrunc = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   level = 0.95,   psi = NULL,   weights = NULL,   confint = TRUE )"},{"path":"https://lbelzile.github.io/longevity/reference/prof_gp_scalet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Profile log likelihood for the transformed scale parameter of the generalized Pareto distribution — prof_gp_scalet","text":"mle object class elife_par time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. thresh vector thresholds ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". level level confidence interval weights weights observations confint logical; TRUE (default), return confidence intervals rather list","code":""},{"path":"https://lbelzile.github.io/longevity/reference/prof_gp_scalet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Profile log likelihood for the transformed scale parameter of the generalized Pareto distribution — prof_gp_scalet","text":"confidence interval","code":""},{"path":"https://lbelzile.github.io/longevity/reference/prof_gp_shape.html","id":null,"dir":"Reference","previous_headings":"","what":"Profile log likelihood for the shape parameter of the generalized Pareto distribution — prof_gp_shape","title":"Profile log likelihood for the shape parameter of the generalized Pareto distribution — prof_gp_shape","text":"internal function used produce threshold stability plots.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/prof_gp_shape.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Profile log likelihood for the shape parameter of the generalized Pareto distribution — prof_gp_shape","text":"","code":"prof_gp_shape(   mle = NULL,   time,   time2 = NULL,   event = NULL,   thresh,   ltrunc = NULL,   rtrunc = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   level = 0.95,   psi = NULL,   weights = NULL,   confint = TRUE )"},{"path":"https://lbelzile.github.io/longevity/reference/prof_gp_shape.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Profile log likelihood for the shape parameter of the generalized Pareto distribution — prof_gp_shape","text":"mle object class elife_par time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. thresh vector thresholds ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". level level confidence interval weights weights observations confint logical; TRUE (default), return confidence intervals rather list","code":""},{"path":"https://lbelzile.github.io/longevity/reference/prof_gp_shape.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Profile log likelihood for the shape parameter of the generalized Pareto distribution — prof_gp_shape","text":"confint=TRUE, vector length three maximum likelihood shape profile-based confidence interval","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qbeard.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile function of the Beard distribution — qbeard","title":"Quantile function of the Beard distribution — qbeard","text":"Quantile function Beard distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qbeard.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile function of the Beard distribution — qbeard","text":"","code":"qbeard(p, rate = 1, shape1 = 1, shape2 = 1, lower.tail = TRUE)"},{"path":"https://lbelzile.github.io/longevity/reference/qbeard.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile function of the Beard distribution — qbeard","text":"p vector probabilities. rate rate parameter (\\(\\nu\\)) shape1 shape parameter (\\(\\alpha\\)) shape2 shape parameter (\\(\\beta\\)) lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qbeard.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile function of the Beard distribution — qbeard","text":"vector quantiles","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qbeardmake.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile function of the Beard-Makeham distribution — qbeardmake","title":"Quantile function of the Beard-Makeham distribution — qbeardmake","text":"Quantile function Beard-Makeham distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qbeardmake.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile function of the Beard-Makeham distribution — qbeardmake","text":"","code":"qbeardmake(p, rate = 1, shape1 = 1, shape2 = 1, lambda = 0, lower.tail = TRUE)"},{"path":"https://lbelzile.github.io/longevity/reference/qbeardmake.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile function of the Beard-Makeham distribution — qbeardmake","text":"p vector probabilities. rate shape parameter (\\(\\nu\\)) shape1 shape parameter (\\(\\alpha\\)) shape2 shape parameter (\\(\\beta\\)) lambda exponential rate Makeham component lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qbeardmake.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile function of the Beard-Makeham distribution — qbeardmake","text":"vector quantiles","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qextgp.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile function of the extended generalized Pareto distribution — qextgp","title":"Quantile function of the extended generalized Pareto distribution — qextgp","text":"Quantile function extended generalized Pareto distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qextgp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile function of the extended generalized Pareto distribution — qextgp","text":"","code":"qextgp(p, scale = 1, shape1 = 0, shape2 = 0, lower.tail = TRUE)"},{"path":"https://lbelzile.github.io/longevity/reference/qextgp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile function of the extended generalized Pareto distribution — qextgp","text":"p vector probabilities. scale scale parameter, strictly positive. shape1 positive shape parameter \\(\\beta\\); model defaults generalized Pareto equals zero. shape2 shape parameter \\(\\gamma\\); model reduces Gompertz shape2=0. lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qextgp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile function of the extended generalized Pareto distribution — qextgp","text":"vector quantiles","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qextweibull.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile function of the extended Weibull distribution — qextweibull","title":"Quantile function of the extended Weibull distribution — qextweibull","text":"Quantile function extended Weibull distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qextweibull.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile function of the extended Weibull distribution — qextweibull","text":"","code":"qextweibull(p, scale = 1, shape1 = 0, shape2 = 1, lower.tail = TRUE)"},{"path":"https://lbelzile.github.io/longevity/reference/qextweibull.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile function of the extended Weibull distribution — qextweibull","text":"p vector probabilities. scale scale parameter, strictly positive. shape1 shape parameter generalized Pareto component. shape2 shape parameter Weibull component. lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qextweibull.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile function of the extended Weibull distribution — qextweibull","text":"vector quantiles","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qgomp.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile function of the Gompertz distribution — qgomp","title":"Quantile function of the Gompertz distribution — qgomp","text":"Quantile function Gompertz distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qgomp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile function of the Gompertz distribution — qgomp","text":"","code":"qgomp(p, scale = 1, shape = 0, lower.tail = TRUE)"},{"path":"https://lbelzile.github.io/longevity/reference/qgomp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile function of the Gompertz distribution — qgomp","text":"p vector probabilities. scale scale parameter, strictly positive. shape shape parameter. lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qgomp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile function of the Gompertz distribution — qgomp","text":"vector quantiles","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qgompmake.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile function of the Gompertz-Makeham distribution — qgompmake","title":"Quantile function of the Gompertz-Makeham distribution — qgompmake","text":"Quantile function Gompertz-Makeham distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qgompmake.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile function of the Gompertz-Makeham distribution — qgompmake","text":"","code":"qgompmake(p, scale = 1, shape = 0, lambda = 0, lower.tail = TRUE)"},{"path":"https://lbelzile.github.io/longevity/reference/qgompmake.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile function of the Gompertz-Makeham distribution — qgompmake","text":"p vector probabilities. scale scale parameter, strictly positive. shape shape parameter. lambda exponential rate lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qgompmake.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile function of the Gompertz-Makeham distribution — qgompmake","text":"vector quantiles","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qgompmake.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Quantile function of the Gompertz-Makeham distribution — qgompmake","text":"quantile function defined terms Lambert's W function. Particular parameter combinations (small values lambda lead numerical overflow; function throws warning happens.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qgpd.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile function of the generalized Pareto distribution — qgpd","title":"Quantile function of the generalized Pareto distribution — qgpd","text":"Quantile function generalized Pareto distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qgpd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile function of the generalized Pareto distribution — qgpd","text":"","code":"qgpd(p, loc = 0, scale = 1, shape = 0, lower.tail = TRUE)"},{"path":"https://lbelzile.github.io/longevity/reference/qgpd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile function of the generalized Pareto distribution — qgpd","text":"p vector probabilities. loc location parameter. scale scale parameter, strictly positive. shape shape parameter. lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qgpd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile function of the generalized Pareto distribution — qgpd","text":"vector quantiles","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qperks.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile function of the Perks distribution — qperks","title":"Quantile function of the Perks distribution — qperks","text":"Quantile function Perks distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qperks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile function of the Perks distribution — qperks","text":"","code":"qperks(p, rate = 1, shape = 1, lower.tail = TRUE)"},{"path":"https://lbelzile.github.io/longevity/reference/qperks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile function of the Perks distribution — qperks","text":"p vector probabilities. rate rate parameter (\\(\\nu\\)) shape shape parameter (\\(\\alpha\\)) lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qperks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile function of the Perks distribution — qperks","text":"vector quantiles","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qperksmake.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile function of the Perks-Makeham distribution — qperksmake","title":"Quantile function of the Perks-Makeham distribution — qperksmake","text":"Quantile function Perks-Makeham distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qperksmake.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile function of the Perks-Makeham distribution — qperksmake","text":"","code":"qperksmake(p, rate = 1, shape = 1, lambda = 0, lower.tail = TRUE)"},{"path":"https://lbelzile.github.io/longevity/reference/qperksmake.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile function of the Perks-Makeham distribution — qperksmake","text":"p vector probabilities. rate rate parameter (\\(\\nu\\)) shape shape parameter (\\(\\alpha\\)) lambda exponential rate Makeham component lower.tail logical; TRUE (default), lower tail probability \\(\\Pr(X \\leq x)\\) returned.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/qperksmake.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile function of the Perks-Makeham distribution — qperksmake","text":"vector quantiles","code":""},{"path":"https://lbelzile.github.io/longevity/reference/r_ditrunc_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample observations from an interval truncated excess lifetime distribution — r_ditrunc_elife","title":"Sample observations from an interval truncated excess lifetime distribution — r_ditrunc_elife","text":"Sample observations interval truncated excess lifetime distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/r_ditrunc_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample observations from an interval truncated excess lifetime distribution — r_ditrunc_elife","text":"","code":"r_ditrunc_elife(   n,   scale,   shape,   lower,   upper,   family = c(\"exp\", \"gp\", \"gomp\", \"gompmake\", \"weibull\", \"extgp\") )"},{"path":"https://lbelzile.github.io/longevity/reference/r_ditrunc_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample observations from an interval truncated excess lifetime distribution — r_ditrunc_elife","text":"n sample size scale scale parameter(s) shape shape parameter(s) lower vector lower bounds upper vector upper bounds family string; choice parametric family, either exponential (exp), Weibull (weibull), generalized Pareto (gp), Gompertz (gomp), Gompertz-Makeham (gompmake) extended generalized Pareto (extgp).","code":""},{"path":"https://lbelzile.github.io/longevity/reference/r_ditrunc_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample observations from an interval truncated excess lifetime distribution — r_ditrunc_elife","text":"vector n observations","code":""},{"path":"https://lbelzile.github.io/longevity/reference/r_ditrunc_elife.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample observations from an interval truncated excess lifetime distribution — r_ditrunc_elife","text":"","code":"n <- 100L # the lower and upper bound are either scalar, # or else vectors of length n r_dtrunc_elife(n = n, scale = 1, shape = -0.1,                lower = pmax(0, runif(n, -0.5, 1)),                upper = runif(n, 6, 10),                family = \"gp\") #>   [1] 0.58025009 2.59985618 1.24786952 0.72735563 0.92574431 1.73849416 #>   [7] 2.84178998 1.18222667 1.86012936 0.97052633 3.04722079 0.10564937 #>  [13] 0.59393785 1.69252041 0.32414608 1.05078377 0.96430925 0.84810836 #>  [19] 3.50172140 0.31389855 1.44191497 0.61242685 0.43111313 1.29195858 #>  [25] 0.86558521 0.12413623 1.00192036 1.24829229 1.74941939 3.16538912 #>  [31] 0.89496372 0.16207944 1.94883430 0.46192666 0.28241805 1.00576959 #>  [37] 1.58413652 0.53475080 0.61849133 0.12982633 0.95750412 0.64473116 #>  [43] 1.19281072 0.39354711 0.50456404 0.52242855 1.02790873 2.11439841 #>  [49] 1.31320329 0.80247167 0.33156666 1.85329470 3.04144057 0.68152476 #>  [55] 0.30284510 0.35818896 0.25471761 1.49836028 1.52264519 0.60478588 #>  [61] 1.16306984 2.82886081 1.53935393 0.20716444 1.15605402 4.28633989 #>  [67] 0.83817925 0.69511100 0.75207124 2.37857723 0.90045716 0.01069799 #>  [73] 1.30257105 2.37221523 1.50231844 1.79642989 1.14811245 1.37044963 #>  [79] 0.60100852 1.13586664 0.05160670 0.55058284 1.14345822 0.73845164 #>  [85] 1.82338410 1.33455938 3.36785663 0.07345253 2.80435514 2.98673757 #>  [91] 0.91169081 0.79072175 0.88138582 0.87276393 1.00144294 2.84326843 #>  [97] 0.86738734 0.35631843 1.09544771 1.35693429"},{"path":"https://lbelzile.github.io/longevity/reference/r_dtrunc_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample observations from an interval truncated excess lifetime distribution — r_dtrunc_elife","title":"Sample observations from an interval truncated excess lifetime distribution — r_dtrunc_elife","text":"Sample observations interval truncated excess lifetime distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/r_dtrunc_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample observations from an interval truncated excess lifetime distribution — r_dtrunc_elife","text":"","code":"r_dtrunc_elife(   n,   scale,   shape,   lower,   upper,   family = c(\"exp\", \"gp\", \"gomp\", \"gompmake\", \"weibull\", \"extgp\") )"},{"path":"https://lbelzile.github.io/longevity/reference/r_dtrunc_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample observations from an interval truncated excess lifetime distribution — r_dtrunc_elife","text":"n sample size scale scale parameter(s) shape shape parameter(s) lower vector lower bounds upper vector upper bounds family string; choice parametric family, either exponential (exp), Weibull (weibull), generalized Pareto (gp), Gompertz (gomp), Gompertz-Makeham (gompmake) extended generalized Pareto (extgp).","code":""},{"path":"https://lbelzile.github.io/longevity/reference/r_dtrunc_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample observations from an interval truncated excess lifetime distribution — r_dtrunc_elife","text":"vector n observations","code":""},{"path":"https://lbelzile.github.io/longevity/reference/r_dtrunc_elife.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample observations from an interval truncated excess lifetime distribution — r_dtrunc_elife","text":"","code":"n <- 100L # the lower and upper bound are either scalar, # or else vectors of length n r_dtrunc_elife(n = n, scale = 1, shape = -0.1,                lower = pmax(0, runif(n, -0.5, 1)),                upper = runif(n, 6, 10),                family = \"gp\") #>   [1] 2.49946336 2.01694956 2.73123586 0.28892848 0.67678126 1.69446274 #>   [7] 0.87512609 0.82394260 0.72849275 0.49896497 1.71371272 0.40255351 #>  [13] 3.85000965 0.95171903 1.15985232 1.04527785 1.62127355 0.85231925 #>  [19] 0.31549035 0.89895608 2.41055892 1.24156347 0.61155632 1.13099274 #>  [25] 1.46898319 1.50009070 1.22230854 0.32801049 3.20276150 0.36092852 #>  [31] 0.30528064 0.43120185 1.94962327 1.85248584 3.82907930 1.12011742 #>  [37] 0.01074014 0.45635476 1.24652132 2.33568908 1.67029532 0.91436935 #>  [43] 0.87434177 0.70263529 1.92628837 1.32049871 2.49933088 0.45158134 #>  [49] 1.44550803 1.96171239 0.27226772 1.53079531 1.47244980 0.74676488 #>  [55] 0.95316168 0.79622326 0.93637477 0.07333934 2.51355893 0.15077384 #>  [61] 1.08557492 0.29597259 2.17725111 1.28740885 0.26079413 2.63968047 #>  [67] 0.40034876 1.43253874 1.44326741 0.89539729 1.20056515 0.45265391 #>  [73] 0.92426801 0.12684600 0.59468883 0.80537332 1.00767616 1.46206219 #>  [79] 1.39808453 0.45974224 2.17056223 2.91409698 0.75939958 0.87506914 #>  [85] 1.23578673 1.81392181 0.86454096 2.20662364 2.20712921 0.92143902 #>  [91] 0.63322433 3.24692621 0.28253976 3.25267359 0.26484122 3.43992362 #>  [97] 0.84381955 2.55399575 0.29286344 0.96814956"},{"path":"https://lbelzile.github.io/longevity/reference/r_ltrc_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample observations from a left-truncated right-censored excess lifetime distribution — r_ltrc_elife","title":"Sample observations from a left-truncated right-censored excess lifetime distribution — r_ltrc_elife","text":"Sample observations left-truncated right-censored excess lifetime distribution","code":""},{"path":"https://lbelzile.github.io/longevity/reference/r_ltrc_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample observations from a left-truncated right-censored excess lifetime distribution — r_ltrc_elife","text":"","code":"r_ltrc_elife(   n,   scale,   shape,   lower,   upper,   family = c(\"exp\", \"gp\", \"gomp\", \"gompmake\", \"weibull\", \"extgp\") )"},{"path":"https://lbelzile.github.io/longevity/reference/r_ltrc_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample observations from a left-truncated right-censored excess lifetime distribution — r_ltrc_elife","text":"n sample size scale scale parameter shape shape parameter(s) lower vector lower bounds upper vector upper bounds data right-truncated family string; choice parametric family, either exponential (exp), Weibull (weibull), generalized Pareto (gp), Gompertz (gomp) extended generalized Pareto (extgp).","code":""},{"path":"https://lbelzile.github.io/longevity/reference/r_ltrc_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample observations from a left-truncated right-censored excess lifetime distribution — r_ltrc_elife","text":"list n observations dat logical vector length TRUE right-censored observations FALSE otherwise.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/r_ltrc_elife.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample observations from a left-truncated right-censored excess lifetime distribution — r_ltrc_elife","text":"","code":"n <- 100L # the lower and upper bound are either scalar, # or else vectors of length n r_ltrc_elife(n = n, scale = 5, shape = -0.1,                lower = pmax(0, runif(n, -0.5, 1)),                upper = 5,                family = \"gp\") #> $dat #>   [1] 0.83585031 1.70880263 1.42453756 0.23144122 5.00000000 2.30562718 #>   [7] 5.00000000 5.00000000 5.00000000 5.00000000 0.98456910 5.00000000 #>  [13] 4.23002522 3.79779690 5.00000000 3.22040734 2.36824187 4.92932685 #>  [19] 5.00000000 4.51399962 0.68632641 5.00000000 1.71437057 5.00000000 #>  [25] 1.31848157 4.16504406 5.00000000 5.00000000 5.00000000 5.00000000 #>  [31] 1.61895191 3.43188558 4.55637117 5.00000000 5.00000000 4.98305949 #>  [37] 5.00000000 2.17279614 3.41941684 0.33345183 0.91456334 3.90535302 #>  [43] 5.00000000 4.89610244 5.00000000 5.00000000 5.00000000 0.83252402 #>  [49] 5.00000000 2.94284346 5.00000000 5.00000000 3.47590448 4.78226746 #>  [55] 2.64897262 0.67223497 0.77181044 4.22477841 0.54207303 5.00000000 #>  [61] 5.00000000 5.00000000 5.00000000 5.00000000 0.06680135 1.91516450 #>  [67] 1.18540923 1.40385110 4.33768433 3.70974599 2.99813398 1.86198048 #>  [73] 5.00000000 5.00000000 4.67124875 1.23677220 4.40157209 5.00000000 #>  [79] 1.08246176 1.26011020 4.70711602 0.57334641 4.30333837 5.00000000 #>  [85] 1.91817546 1.73946531 4.15969778 3.26331840 5.00000000 4.55242661 #>  [91] 3.61251745 0.30208529 4.13543701 1.10502980 1.13631242 2.60020902 #>  [97] 1.17203675 5.00000000 4.13022425 5.00000000 #>  #> $rcens #>   [1] FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE #>  [13] FALSE FALSE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE  TRUE FALSE  TRUE #>  [25] FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE  TRUE  TRUE FALSE #>  [37]  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE  TRUE  TRUE  TRUE FALSE #>  [49]  TRUE FALSE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE #>  [61]  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE #>  [73]  TRUE  TRUE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE #>  [85] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE #>  [97] FALSE  TRUE FALSE  TRUE #>"},{"path":"https://lbelzile.github.io/longevity/reference/samp2_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample lifetime from excess lifetime model — samp2_elife","title":"Sample lifetime from excess lifetime model — samp2_elife","text":"Given parameters elife distribution, sampling window birth dates excess lifetimes, sample new observations; excess lifetime c1 sampled exponential distribution, whereas birth dates sampled jittered histogram-based distribution new excess lifetime threshold right-censored exceed c2.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/samp2_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample lifetime from excess lifetime model — samp2_elife","text":"","code":"samp2_elife(   n,   scale,   shape,   family = c(\"exp\", \"gp\", \"gomp\", \"gompmake\", \"weibull\", \"extgp\"),   xcal,   c1,   c2 )"},{"path":"https://lbelzile.github.io/longevity/reference/samp2_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample lifetime from excess lifetime model — samp2_elife","text":"n sample size scale scale parameter(s) shape shape parameter(s) family string; choice parametric family, either exponential (exp), Weibull (weibull), generalized Pareto (gp), Gompertz (gomp), Gompertz-Makeham (gompmake) extended generalized Pareto (extgp). xcal date individual reaches u years c1 date, first day sampling frame c2 date, last day sampling frame","code":""},{"path":"https://lbelzile.github.io/longevity/reference/samp2_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample lifetime from excess lifetime model — samp2_elife","text":"list new birthdates (xcal), excess lifetime c1 (ltrunc), excess lifetime u (dat) right-censoring indicator (rightcens).","code":""},{"path":"https://lbelzile.github.io/longevity/reference/samp_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate excess lifetime with truncation or right-censoring — samp_elife","title":"Simulate excess lifetime with truncation or right-censoring — samp_elife","text":"function dispatches simulations accounting potential left-truncation (remove setting lower zero). type2=ltrt, simulated observations lower upper bounds upper. type2=ltrc, simulated observations capped upper observation right-censored (rcens=TRUE).","code":""},{"path":"https://lbelzile.github.io/longevity/reference/samp_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate excess lifetime with truncation or right-censoring — samp_elife","text":"","code":"samp_elife(   n,   scale,   shape = NULL,   lower = 0,   upper = Inf,   family = c(\"exp\", \"gp\", \"gomp\", \"gompmake\", \"weibull\", \"extgp\", \"gppiece\"),   type2 = c(\"none\", \"ltrt\", \"ltrc\", \"ditrunc\") )"},{"path":"https://lbelzile.github.io/longevity/reference/samp_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate excess lifetime with truncation or right-censoring — samp_elife","text":"n sample size scale scale parameter(s) shape shape parameter(s) lower vector lower bounds upper vector upper bounds family string; choice parametric family, either exponential (exp), Weibull (weibull), generalized Pareto (gp), Gompertz (gomp), Gompertz-Makeham (gompmake) extended generalized Pareto (extgp). type2 string, either none, ltrt left- right-truncated data ltrc left-truncated right-censored data","code":""},{"path":"https://lbelzile.github.io/longevity/reference/samp_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate excess lifetime with truncation or right-censoring — samp_elife","text":"either vector observations , type2=ltrc, list n observations dat logical vector length TRUE right-censored observations FALSE otherwise.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/test_ditrunc_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood ratio test for doubly interval truncated data — test_ditrunc_elife","title":"Likelihood ratio test for doubly interval truncated data — test_ditrunc_elife","text":"function fits separate models distinct value covariates computes likelihood ratio test test whether significant differences groups.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/test_ditrunc_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood ratio test for doubly interval truncated data — test_ditrunc_elife","text":"","code":"test_ditrunc_elife(   time,   covariate,   thresh = 0,   ltrunc1 = NULL,   rtrunc1 = NULL,   ltrunc2 = NULL,   rtrunc2 = NULL,   family = c(\"exp\", \"gp\", \"weibull\", \"gomp\", \"gompmake\", \"extgp\"),   weights = rep(1, length(time)) )"},{"path":"https://lbelzile.github.io/longevity/reference/test_ditrunc_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood ratio test for doubly interval truncated data — test_ditrunc_elife","text":"time excess time event follow-time, depending value event covariate vector factors, logical integer whose distinct values thresh vector thresholds family string; choice parametric family weights weights observations","code":""},{"path":"https://lbelzile.github.io/longevity/reference/test_ditrunc_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood ratio test for doubly interval truncated data — test_ditrunc_elife","text":"list elements stat: likelihood ratio statistic df: degrees freedom pval: p-value obtained asymptotic chi-square approximation.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/test_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Likelihood ratio test for covariates — test_elife","title":"Likelihood ratio test for covariates — test_elife","text":"function fits separate models distinct value factor covariate computes likelihood ratio test test whether significant differences groups.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/test_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Likelihood ratio test for covariates — test_elife","text":"","code":"test_elife(   time,   time2 = NULL,   event = NULL,   covariate,   thresh = 0,   ltrunc = NULL,   rtrunc = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   family = c(\"exp\", \"gp\", \"weibull\", \"gomp\", \"gompmake\", \"extgp\", \"extweibull\", \"perks\",     \"perksmake\", \"beard\", \"beardmake\"),   weights = rep(1, length(time)) )"},{"path":"https://lbelzile.github.io/longevity/reference/test_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Likelihood ratio test for covariates — test_elife","text":"time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. covariate vector factors, logical integer whose distinct values thresh vector thresholds ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". family string; choice parametric family weights weights observations","code":""},{"path":"https://lbelzile.github.io/longevity/reference/test_elife.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Likelihood ratio test for covariates — test_elife","text":"list elements stat: likelihood ratio statistic df: degrees freedom pval: p-value obtained asymptotic chi-square approximation.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/test_elife.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Likelihood ratio test for covariates — test_elife","text":"","code":"with(uk110, test_elife(time = ndays, thresh = 40178L, covariate = gender, ltrunc = ltrunc, rtrunc = rtrunc, family = \"exp\", type = \"ltrt\")) #> Error in with(uk110, test_elife(time = ndays, thresh = 40178L, covariate = gender,     ltrunc = ltrunc, rtrunc = rtrunc, family = \"exp\", type = \"ltrt\")): object 'uk110' not found"},{"path":"https://lbelzile.github.io/longevity/reference/tstab.html","id":null,"dir":"Reference","previous_headings":"","what":"Threshold stability plots — tstab","title":"Threshold stability plots — tstab","text":"generalized Pareto exponential distribution threshold stable. property, used extrapolation purposes, can also used diagnose goodness--fit: expect parameters \\(\\xi\\) \\(\\tilde{\\sigma} = \\sigma + \\xi u\\) constant range thresholds. threshold stability plot consists plotting maximum likelihood estimates pointwise confidence interval. function handles interval truncation right-censoring.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/tstab.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Threshold stability plots — tstab","text":"","code":"tstab(   time,   time2 = NULL,   event = NULL,   thresh = 0,   ltrunc = NULL,   rtrunc = NULL,   type = c(\"right\", \"left\", \"interval\", \"interval2\"),   family = c(\"gp\", \"exp\"),   method = c(\"wald\", \"profile\"),   level = 0.95,   plot = TRUE,   plot.type = c(\"base\", \"ggplot\"),   which.plot = c(\"scale\", \"shape\"),   weights = NULL )"},{"path":"https://lbelzile.github.io/longevity/reference/tstab.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Threshold stability plots — tstab","text":"time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . event status indicator, normally 0=alive, 1=dead. choices TRUE/FALSE (TRUE death). interval censored data, status indicator 0=right censored, 1=event time, 2=left censored, 3=interval censored. Although unusual, event indicator can omitted, case subjects assumed experienced event. thresh vector thresholds ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL type character string specifying type censoring. Possible values \"right\", \"left\", \"interval\", \"interval2\". family string; distribution, either generalized Pareto (gp) exponential (exp) method string; type pointwise confidence interval, either Wald (wald) profile likelihood (profile) level probability level pointwise confidence intervals plot logical; plot returned alongside estimates? Default TRUE plot.type string; either base base R plots ggplot ggplot2 plots .plot string; parameters plot; weights weights observations","code":""},{"path":"https://lbelzile.github.io/longevity/reference/tstab.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Threshold stability plots — tstab","text":"invisible list pointwise estimates confidence intervals scale shape parameters","code":""},{"path":"https://lbelzile.github.io/longevity/reference/tstab.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Threshold stability plots — tstab","text":"shape estimates constrained","code":""},{"path":[]},{"path":"https://lbelzile.github.io/longevity/reference/turnbull_intervals.html","id":null,"dir":"Reference","previous_headings":"","what":"Turnbull's sets — turnbull_intervals","title":"Turnbull's sets — turnbull_intervals","text":"Given censoring truncation set, compute regions real line get positive mass distribution function well-defined.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/turnbull_intervals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Turnbull's sets — turnbull_intervals","text":"","code":"turnbull_intervals(time, time2 = NULL, status, ltrunc = NULL, rtrunc = NULL)"},{"path":"https://lbelzile.github.io/longevity/reference/turnbull_intervals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Turnbull's sets — turnbull_intervals","text":"time excess time event follow-time, depending value event time2 ending excess time interval interval censored data . ltrunc lower truncation limit, default NULL rtrunc upper truncation limit, default NULL","code":""},{"path":"https://lbelzile.github.io/longevity/reference/turnbull_intervals.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Turnbull's sets — turnbull_intervals","text":"function adds square root machine tolerance left bounds interval censored data open.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/turnbull_intervals.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Turnbull's sets — turnbull_intervals","text":"Frydman, H. (1994). Note Nonparametric Estimation Distribution Function Interval-Censored Truncated Observations, Journal Royal Statistical Society. Series B (Methodological) 56(1), 71-74. Turnbull, B. W. (1976). Empirical Distribution Function Arbitrarily Grouped, Censored Truncated Data. Journal Royal Statistical Society, Series B 38, 290-295.","code":""},{"path":"https://lbelzile.github.io/longevity/reference/uq1_qqplot_elife.html","id":null,"dir":"Reference","previous_headings":"","what":"Uncertainty quantification for quantile-quantile plots — uq1_qqplot_elife","title":"Uncertainty quantification for quantile-quantile plots — uq1_qqplot_elife","text":"Uncertainty quantification quantile-quantile plots","code":""},{"path":"https://lbelzile.github.io/longevity/reference/uq1_qqplot_elife.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Uncertainty quantification for quantile-quantile plots — uq1_qqplot_elife","text":"","code":"uq1_qqplot_elife(   B = 9999L,   dat,   par,   lower,   upper,   level = 0.95,   type2 = c(\"none\", \"ltrt\", \"ltrc\"),   family = c(\"exp\", \"gp\", \"gomp\", \"gompmake\", \"weibull\", \"extgp\") )"},{"path":"https://lbelzile.github.io/longevity/reference/uq1_qqplot_elife.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Uncertainty quantification for quantile-quantile plots — uq1_qqplot_elife","text":"B number bootstrap samples dat vector data par parameter estimates model lower lower bounds (truncation lowest possible value) upper upper bound right-censoring right-truncation level level confidence intervals family string; choice parametric family","code":""}]
