<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function is a wrapper around constrained optimization
routines for different models with non-informative
censoring and truncation patterns."><title>Fit excess lifetime models by maximum likelihood — fit_elife • longevity</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit excess lifetime models by maximum likelihood — fit_elife"><meta property="og:description" content="This function is a wrapper around constrained optimization
routines for different models with non-informative
censoring and truncation patterns."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">longevity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2023.08.24</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/introduction.html">Introducing longevity</a>
    <a class="dropdown-item" href="../articles/nonparametric.html">Nonparametric maximum likelihood estimation for survival data</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lbelzile/longevity/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit excess lifetime models by maximum likelihood</h1>
      <small class="dont-index">Source: <a href="https://github.com/lbelzile/longevity/blob/HEAD/R/parametric.R" class="external-link"><code>R/parametric.R</code></a></small>
      <div class="d-none name"><code>fit_elife.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is a wrapper around constrained optimization
routines for different models with non-informative
censoring and truncation patterns.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_elife</span><span class="op">(</span></span>
<span>  <span class="va">time</span>,</span>
<span>  time2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  event <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"left"</span>, <span class="st">"interval"</span>, <span class="st">"interval2"</span><span class="op">)</span>,</span>
<span>  ltrunc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rtrunc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thresh <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  status <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exp"</span>, <span class="st">"gp"</span>, <span class="st">"weibull"</span>, <span class="st">"gomp"</span>, <span class="st">"gompmake"</span>, <span class="st">"extgp"</span>, <span class="st">"gppiece"</span>,</span>
<span>    <span class="st">"extweibull"</span>, <span class="st">"perks"</span>, <span class="st">"perksmake"</span>, <span class="st">"beard"</span>, <span class="st">"beardmake"</span><span class="op">)</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  export <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  restart <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  arguments <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>time</dt>
<dd><p>excess time of the event of follow-up time, depending on the value of event</p></dd>


<dt>time2</dt>
<dd><p>ending excess time of the interval for interval censored data only.</p></dd>


<dt>event</dt>
<dd><p>status indicator, normally 0=alive, 1=dead. Other choices are <code>TRUE</code>/<code>FALSE</code> (<code>TRUE</code> for death).
For interval censored data, the status indicator is 0=right censored, 1=event at time, 2=left censored, 3=interval censored.
Although unusual, the event indicator can be omitted, in which case all subjects are assumed to have experienced an event.</p></dd>


<dt>type</dt>
<dd><p>character string specifying the type of censoring. Possible values are "<code>right</code>", "<code>left</code>", "<code>interval</code>", "<code>interval2</code>".</p></dd>


<dt>ltrunc</dt>
<dd><p>lower truncation limit, default to <code>NULL</code></p></dd>


<dt>rtrunc</dt>
<dd><p>upper truncation limit, default to <code>NULL</code></p></dd>


<dt>thresh</dt>
<dd><p>vector of thresholds</p></dd>


<dt>status</dt>
<dd><p>integer vector giving status of an observation. If <code>NULL</code> (default), this argument is computed internally based on <code>type</code>.</p></dd>


<dt>family</dt>
<dd><p>string; choice of parametric family</p></dd>


<dt>weights</dt>
<dd><p>weights for observations</p></dd>


<dt>export</dt>
<dd><p>logical; should data be included in the returned object to produce diagnostic plots? Default to <code>FALSE</code>.</p></dd>


<dt>start</dt>
<dd><p>vector of starting values for the optimization routine. If <code>NULL</code>, the algorithm attempts to find default values and returns a warning with
false convergence diagnostic if it cannot.</p></dd>


<dt>restart</dt>
<dd><p>logical; should multiple starting values be attempted? Default to <code>FALSE</code>.</p></dd>


<dt>arguments</dt>
<dd><p>a named list specifying default arguments of the function that are common to all <code>elife</code> calls</p></dd>


<dt>...</dt>
<dd><p>additional parameters, currently ignored</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>an object of class <code>elife_par</code></p>


    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The extended generalized Pareto model is constrained
to avoid regions where the likelihood is flat so \(\xi \in [-1, 10]\) in
the optimization algorithm.</p>
<p>The standard errors are obtained via the observed information matrix, calculated
using the hessian. In many instances, such as when the shape parameter is zero
or negative, the hessian is singular and no estimates are returned.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ewsim</span>, package <span class="op">=</span> <span class="st">"longevity"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">fit_elife</span><span class="op">(</span></span></span>
<span class="r-in"><span>   arguments <span class="op">=</span> <span class="va">ewsim</span>,</span></span>
<span class="r-in"><span>   export <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   family <span class="op">=</span> <span class="st">"exp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">fit_elife</span><span class="op">(</span></span></span>
<span class="r-in"><span>   arguments <span class="op">=</span> <span class="va">ewsim</span>,</span></span>
<span class="r-in"><span>   export <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   family <span class="op">=</span> <span class="st">"gp"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="fit_elife-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="fit_elife-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: exponential distribution. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sampling: interval truncated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: -219.797 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Threshold: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of exceedances: 179 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1.35  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard Errors</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.108  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimization Information</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Convergence: TRUE </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit2</span>, <span class="va">fit1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     npar Deviance Df        Chisq Pr(&gt;Chisq)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gp     2  439.594 NA           NA         NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> exp    1  439.594  1 3.419987e-05  0.9953339</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Leo Belzile.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

